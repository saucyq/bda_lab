{
  "paragraphs": [
    {
      "text": "%md [Source](https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/2799933550853697/4438435960036599/2202577924924539/latest.html)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.456",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003e\u003ca href\u003d\"https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/2799933550853697/4438435960036599/2202577924924539/latest.html\"\u003eSource\u003c/a\u003e\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863456_2041840986",
      "id": "20180421-064454_933013450",
      "dateCreated": "2025-03-30 13:37:43.456",
      "status": "READY"
    },
    {
      "text": "%md\n![Spark Logo](http://spark-mooc.github.io/web-assets/images/ta_Spark-logo-small.png)\n# **Web Server Log Analysis with Apache Spark**\n\nIn this lab you will be performing web server log analysis with Apache Spark.\n\nServer log analysis is an ideal use case for Spark.  It\u0027s a very large, common data source and contains a rich set of information.  Spark allows you to store your logs in files on disk cheaply, while still providing a quick and simple way to perform data analysis on them.  This lab will show you how to use Apache Spark on real-world text-based production logs and fully harness the power of that data.  Log data comes from many sources, such as web, file, and compute servers, application logs, user-generated content,  and can be used for monitoring servers, improving business and customer intelligence, building recommendation systems, fraud detection, and much more.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.457",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003e\u003cimg src\u003d\"http://spark-mooc.github.io/web-assets/images/ta_Spark-logo-small.png\" alt\u003d\"Spark Logo\" /\u003e\u003c/p\u003e\n\u003ch1\u003e\u003cstrong\u003eWeb Server Log Analysis with Apache Spark\u003c/strong\u003e\u003c/h1\u003e\n\u003cp\u003eIn this lab you will be performing web server log analysis with Apache Spark.\u003c/p\u003e\n\u003cp\u003eServer log analysis is an ideal use case for Spark.  It\u0026rsquo;s a very large, common data source and contains a rich set of information.  Spark allows you to store your logs in files on disk cheaply, while still providing a quick and simple way to perform data analysis on them.  This lab will show you how to use Apache Spark on real-world text-based production logs and fully harness the power of that data.  Log data comes from many sources, such as web, file, and compute servers, application logs, user-generated content,  and can be used for monitoring servers, improving business and customer intelligence, building recommendation systems, fraud detection, and much more.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863456_641445394",
      "id": "20180420-160702_2030708936",
      "dateCreated": "2025-03-30 13:37:43.457",
      "status": "READY"
    },
    {
      "text": "%md\n## How to complete this lab\n\nThis lab is broken up into sections with bite-sized examples for demonstrating Spark functionality for log processing.\n\nIt consists of 5 parts:\n\n* *Part 1:* Preliminaries\n* *Part 2:* Exploratory Data Analysis\n* *Part 3*: Analysis Walk-Through on the Web Server Log File\n* *Part 4*: Exercises - Analyzing Web Server Log File\n* *Part 5*: Exercises - Exploring 404 Response Codes\n\nThe first three parts are explanatory, the last two contain exercises for you to complete.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.457",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eHow to complete this lab\u003c/h2\u003e\n\u003cp\u003eThis lab is broken up into sections with bite-sized examples for demonstrating Spark functionality for log processing.\u003c/p\u003e\n\u003cp\u003eIt consists of 5 parts:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003ePart 1:\u003c/em\u003e Preliminaries\u003c/li\u003e\n\u003cli\u003e\u003cem\u003ePart 2:\u003c/em\u003e Exploratory Data Analysis\u003c/li\u003e\n\u003cli\u003e\u003cem\u003ePart 3\u003c/em\u003e: Analysis Walk-Through on the Web Server Log File\u003c/li\u003e\n\u003cli\u003e\u003cem\u003ePart 4\u003c/em\u003e: Exercises - Analyzing Web Server Log File\u003c/li\u003e\n\u003cli\u003e\u003cem\u003ePart 5\u003c/em\u003e: Exercises - Exploring 404 Response Codes\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe first three parts are explanatory, the last two contain exercises for you to complete.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863457_2132308382",
      "id": "20180420-163451_1375514903",
      "dateCreated": "2025-03-30 13:37:43.457",
      "status": "READY"
    },
    {
      "text": "%md\n## Part 1: Preliminaries\n\n### (1a) DataFrame column references in Scala\n\nWhen working with DataFrames in Scala you operate on DataFrame columns and you need to reference them. There are several ways to do it.\n\n* Using the `col` function:\n\n        myDataFrame.select(col(\"someColumnName\"))\n\n* Using the `$` shorthand:\n\n        myDataFrame.select($\"someColumnName\")\n        \nYou can also reference a specific DataFrame\u0027s column explicitly. This is useful when joining two DataFrames where columns have the same name.\n\n        myDataFrame.select(myDataFrame(\"someColumnName\"))\n    ",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.457",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003ePart 1: Preliminaries\u003c/h2\u003e\n\u003ch3\u003e(1a) DataFrame column references in Scala\u003c/h3\u003e\n\u003cp\u003eWhen working with DataFrames in Scala you operate on DataFrame columns and you need to reference them. There are several ways to do it.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eUsing the \u003ccode\u003ecol\u003c/code\u003e function:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e  myDataFrame.select(col(\u0026quot;someColumnName\u0026quot;))\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eUsing the \u003ccode\u003e$\u003c/code\u003e shorthand:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e  myDataFrame.select($\u0026quot;someColumnName\u0026quot;)\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eYou can also reference a specific DataFrame\u0026rsquo;s column explicitly. This is useful when joining two DataFrames where columns have the same name.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e    myDataFrame.select(myDataFrame(\u0026quot;someColumnName\u0026quot;))\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863457_1708169192",
      "id": "20180420-170122_1731127686",
      "dateCreated": "2025-03-30 13:37:43.457",
      "status": "READY"
    },
    {
      "text": "%md\n### (1b) Documentation for DataFrames API\n\nWhen you consult the Scaladoc of the [Spark Scala API](https://spark.apache.org/docs/3.5.5/api/scala/index.html) and search for a \"DataFrame\" class or trait you will not find anything. This is because `DataFrame` is defined as a type alias for `Dataset[Row]`. Consult instead \n\n* [org.apache.spark.sql.Dataset](https://spark.apache.org/docs/3.5.5/api/scala/org/apache/spark/sql/Dataset.html) and\n* [org.apache.spark.sql.Row](https://spark.apache.org/docs/3.5.5/api/scala/org/apache/spark/sql/Row.html).",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.457",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(1b) Documentation for DataFrames API\u003c/h3\u003e\n\u003cp\u003eWhen you consult the Scaladoc of the \u003ca href\u003d\"https://spark.apache.org/docs/3.5.5/api/scala/index.html\"\u003eSpark Scala API\u003c/a\u003e and search for a \u0026ldquo;DataFrame\u0026rdquo; class or trait you will not find anything. This is because \u003ccode\u003eDataFrame\u003c/code\u003e is defined as a type alias for \u003ccode\u003eDataset[Row]\u003c/code\u003e. Consult instead\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href\u003d\"https://spark.apache.org/docs/3.5.5/api/scala/org/apache/spark/sql/Dataset.html\"\u003eorg.apache.spark.sql.Dataset\u003c/a\u003e and\u003c/li\u003e\n\u003cli\u003e\u003ca href\u003d\"https://spark.apache.org/docs/3.5.5/api/scala/org/apache/spark/sql/Row.html\"\u003eorg.apache.spark.sql.Row\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863457_126631545",
      "id": "20180422-200644_355375854",
      "dateCreated": "2025-03-30 13:37:43.457",
      "status": "READY"
    },
    {
      "text": "%md\n## Part 2: Exploratory Data Analysis\n\nLet\u0027s begin looking at our data.  For this lab, we will use a data set from NASA Kennedy Space Center web server in Florida. The full data set is freely available at \u003chttp://ita.ee.lbl.gov/html/contrib/NASA-HTTP.html\u003e, and it contains all HTTP requests for nearly two months. ",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.457",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003ePart 2: Exploratory Data Analysis\u003c/h2\u003e\n\u003cp\u003eLet\u0026rsquo;s begin looking at our data.  For this lab, we will use a data set from NASA Kennedy Space Center web server in Florida. The full data set is freely available at \u003ca href\u003d\"http://ita.ee.lbl.gov/html/contrib/NASA-HTTP.html\"\u003ehttp://ita.ee.lbl.gov/html/contrib/NASA-HTTP.html\u003c/a\u003e, and it contains all HTTP requests for nearly two months.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863457_1411920845",
      "id": "20180420-170245_1791429418",
      "dateCreated": "2025-03-30 13:37:43.457",
      "status": "READY"
    },
    {
      "text": "%sh\n# Download and concatenate the Jul95 and Aug95 log files\n\ncd /data\nif [[ ! -f NASA_access_log_AugJul95.gz ]]\nthen\n    if [[ ! -f NASA_access_log_Jul95.gz ]]\n    then \n        echo \"Downloading NASA_access_log_Jul95.gz\"\n        curl --silent -O https://storage.googleapis.com/lab-dataframes/nasa-access-log/NASA_access_log_Jul95.gz\n    fi\n    if [[ ! -f NASA_access_log_Aug95.gz ]]\n    then \n        echo \"Downloading NASA_access_log_Aug95.gz\"\n        curl --silent -O https://storage.googleapis.com/lab-dataframes/nasa-access-log/NASA_access_log_Aug95.gz\n    fi\n    echo \"Concatenating\"\n    gunzip -nc NASA_access_log_Jul95.gz  \u003e NASA_access_log_AugJul95\n    gunzip -nc NASA_access_log_Aug95.gz \u003e\u003e NASA_access_log_AugJul95\n    echo -n \"Uncompressed: \"\n    ls -lhF NASA_access_log_AugJul95\n    gzip -n NASA_access_log_AugJul95\nfi\necho -n \"  Compressed: \"\nls -lhF NASA_access_log_AugJul95.gz",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:38:01.298",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/sh",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Downloading NASA_access_log_Jul95.gz\nDownloading NASA_access_log_Aug95.gz\nConcatenating\nUncompressed: -rw-r--r-- 1 zeppelin root 356M Mar 30 13:38 NASA_access_log_AugJul95\n  Compressed: -rw-r--r-- 1 zeppelin root 36M Mar 30 13:38 NASA_access_log_AugJul95.gz\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863457_800244334",
      "id": "20180420-170443_102237826",
      "dateCreated": "2025-03-30 13:37:43.457",
      "dateStarted": "2025-03-30 13:38:01.320",
      "dateFinished": "2025-03-30 13:38:24.449",
      "status": "FINISHED"
    },
    {
      "text": "%sh\n# Verify checksum of datafile\necho \"4d46c92ed55119c6917a66b42e36c5fba3f40b97d2f7317a45d03d8d800fc565  /data/NASA_access_log_AugJul95.gz\" | sha256sum --check\necho \"Should print OK\"",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:38:28.761",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/sh",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "/data/NASA_access_log_AugJul95.gz: OK\nShould print OK\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863457_614329194",
      "id": "20180425-084112_621757689",
      "dateCreated": "2025-03-30 13:37:43.457",
      "dateStarted": "2025-03-30 13:38:28.773",
      "dateFinished": "2025-03-30 13:38:29.109",
      "status": "FINISHED"
    },
    {
      "text": "%spark\n// Specify path to downloaded log file\n// Note that Spark is able to read directly gzipped files\nval logFilePath \u003d \"/data/NASA_access_log_AugJul95.gz\"",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:38:32.521",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "val \u001b[1m\u001b[34mlogFilePath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d /data/NASA_access_log_AugJul95.gz\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863457_23392308",
      "id": "20180420-162643_1538489265",
      "dateCreated": "2025-03-30 13:37:43.457",
      "dateStarted": "2025-03-30 13:38:32.544",
      "dateFinished": "2025-03-30 13:38:42.727",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (2a) Loading the log file\n\nNow that we have the path to the file, let\u0027s load it into a DataFrame. We\u0027ll do this in steps. First, we\u0027ll use `sqlContext.read.text()` or `spark.read.text()` to read the text file. This will produce a DataFrame with a single string column called `value`.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.457",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(2a) Loading the log file\u003c/h3\u003e\n\u003cp\u003eNow that we have the path to the file, let\u0026rsquo;s load it into a DataFrame. We\u0026rsquo;ll do this in steps. First, we\u0026rsquo;ll use \u003ccode\u003esqlContext.read.text()\u003c/code\u003e or \u003ccode\u003espark.read.text()\u003c/code\u003e to read the text file. This will produce a DataFrame with a single string column called \u003ccode\u003evalue\u003c/code\u003e.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863457_1768591909",
      "id": "20180420-163229_763145388",
      "dateCreated": "2025-03-30 13:37:43.457",
      "status": "READY"
    },
    {
      "text": "%spark\nval baseDF \u003d spark.read.text(logFilePath)\n// Let\u0027s look at the schema\nbaseDF.printSchema()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:38:40.119",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- value: string (nullable \u003d true)\n\nval \u001b[1m\u001b[34mbaseDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [value: string]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863457_1460319900",
      "id": "20180420-162735_534880828",
      "dateCreated": "2025-03-30 13:37:43.457",
      "dateStarted": "2025-03-30 13:38:42.740",
      "dateFinished": "2025-03-30 13:38:44.320",
      "status": "FINISHED"
    },
    {
      "text": "%md\nLet\u0027s take a look at some of the data.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.457",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eLet\u0026rsquo;s take a look at some of the data.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863457_1009097259",
      "id": "20180420-171431_729912641",
      "dateCreated": "2025-03-30 13:37:43.457",
      "status": "READY"
    },
    {
      "text": "%spark\nval baseDFCount \u003d baseDF.count()\nbaseDF.show(truncate \u003d false)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:38:53.438",
      "progress": 50,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------------------------------------------------------------------------------------------------------------------------------+\n|value                                                                                                                         |\n+------------------------------------------------------------------------------------------------------------------------------+\n|199.72.81.55 - - [01/Jul/1995:00:00:01 -0400] \"GET /history/apollo/ HTTP/1.0\" 200 6245                                        |\n|unicomp6.unicomp.net - - [01/Jul/1995:00:00:06 -0400] \"GET /shuttle/countdown/ HTTP/1.0\" 200 3985                             |\n|199.120.110.21 - - [01/Jul/1995:00:00:09 -0400] \"GET /shuttle/missions/sts-73/mission-sts-73.html HTTP/1.0\" 200 4085          |\n|burger.letters.com - - [01/Jul/1995:00:00:11 -0400] \"GET /shuttle/countdown/liftoff.html HTTP/1.0\" 304 0                      |\n|199.120.110.21 - - [01/Jul/1995:00:00:11 -0400] \"GET /shuttle/missions/sts-73/sts-73-patch-small.gif HTTP/1.0\" 200 4179       |\n|burger.letters.com - - [01/Jul/1995:00:00:12 -0400] \"GET /images/NASA-logosmall.gif HTTP/1.0\" 304 0                           |\n|burger.letters.com - - [01/Jul/1995:00:00:12 -0400] \"GET /shuttle/countdown/video/livevideo.gif HTTP/1.0\" 200 0               |\n|205.212.115.106 - - [01/Jul/1995:00:00:12 -0400] \"GET /shuttle/countdown/countdown.html HTTP/1.0\" 200 3985                    |\n|d104.aa.net - - [01/Jul/1995:00:00:13 -0400] \"GET /shuttle/countdown/ HTTP/1.0\" 200 3985                                      |\n|129.94.144.152 - - [01/Jul/1995:00:00:13 -0400] \"GET / HTTP/1.0\" 200 7074                                                     |\n|unicomp6.unicomp.net - - [01/Jul/1995:00:00:14 -0400] \"GET /shuttle/countdown/count.gif HTTP/1.0\" 200 40310                   |\n|unicomp6.unicomp.net - - [01/Jul/1995:00:00:14 -0400] \"GET /images/NASA-logosmall.gif HTTP/1.0\" 200 786                       |\n|unicomp6.unicomp.net - - [01/Jul/1995:00:00:14 -0400] \"GET /images/KSC-logosmall.gif HTTP/1.0\" 200 1204                       |\n|d104.aa.net - - [01/Jul/1995:00:00:15 -0400] \"GET /shuttle/countdown/count.gif HTTP/1.0\" 200 40310                            |\n|d104.aa.net - - [01/Jul/1995:00:00:15 -0400] \"GET /images/NASA-logosmall.gif HTTP/1.0\" 200 786                                |\n|d104.aa.net - - [01/Jul/1995:00:00:15 -0400] \"GET /images/KSC-logosmall.gif HTTP/1.0\" 200 1204                                |\n|129.94.144.152 - - [01/Jul/1995:00:00:17 -0400] \"GET /images/ksclogo-medium.gif HTTP/1.0\" 304 0                               |\n|199.120.110.21 - - [01/Jul/1995:00:00:17 -0400] \"GET /images/launch-logo.gif HTTP/1.0\" 200 1713                               |\n|ppptky391.asahi-net.or.jp - - [01/Jul/1995:00:00:18 -0400] \"GET /facts/about_ksc.html HTTP/1.0\" 200 3977                      |\n|net-1-141.eden.com - - [01/Jul/1995:00:00:19 -0400] \"GET /shuttle/missions/sts-71/images/KSC-95EC-0916.jpg HTTP/1.0\" 200 34029|\n+------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\nval \u001b[1m\u001b[34mbaseDFCount\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 3461612\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d0"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d1"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d2"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863458_253342605",
      "id": "20180420-162812_249904245",
      "dateCreated": "2025-03-30 13:37:43.458",
      "dateStarted": "2025-03-30 13:38:53.457",
      "dateFinished": "2025-03-30 13:38:56.706",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (2b) Parsing the log file",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.458",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(2b) Parsing the log file\u003c/h3\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863458_341055884",
      "id": "20180420-171447_2120187751",
      "dateCreated": "2025-03-30 13:37:43.458",
      "status": "READY"
    },
    {
      "text": "%md\nIf you\u0027re familiar with web servers at all, you\u0027ll recognize that this is in [Common Log Format](https://www.w3.org/Daemon/User/Config/Logging.html#common-logfile-format). The fields are:\n\n_remotehost rfc931 authuser [date] \"request\" status bytes_\n\n| field         | meaning                                                                |\n| ------------- | ---------------------------------------------------------------------- |\n| _remotehost_  | Remote hostname (or IP number if DNS hostname is not available).       |\n| _rfc931_      | The remote logname of the user. We don\u0027t really care about this field. |\n| _authuser_    | The username of the remote user, as authenticated by the HTTP server.  |\n| _[date]_      | The date and time of the request.                                      |\n| _\"request\"_   | The request, exactly as it came from the browser or client.            |\n| _status_      | The HTTP status code the server sent back to the client.               |\n| _bytes_       | The number of bytes (`Content-Length`) transferred to the client.      |\n\n\nNext, we have to parse it into individual columns. We\u0027ll use the special built-in [regexp\\_extract](https://spark.apache.org/docs/3.5.5/api/scala/org/apache/spark/sql/functions$.html#regexp_extract(e:org.apache.spark.sql.Column,exp:String,groupIdx:Int):org.apache.spark.sql.Column)\nfunction to do the parsing. This function matches a column against a regular expression with one or more [capture groups](http://regexone.com/lesson/capturing_groups) and allows you to extract one of the matched groups. We\u0027ll use one regular expression for each field we wish to extract.\n\nIf you can\u0027t read these regular expressions, don\u0027t worry. Trust us: They work. If you find regular expressions confusing (and they certainly _can_ be), and you want to learn more about them, start with the\n[RegexOne web site](http://regexone.com/). You might also find [_Regular Expressions Cookbook_](http://shop.oreilly.com/product/0636920023630.do), by Jan Goyvaerts and Steven Levithan, to be helpful.\n\n_Some people, when confronted with a problem, think \"I know, I\u0027ll use regular expressions.\" Now they have two problems._ (attributed to Jamie Zawinski)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.458",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eIf you\u0026rsquo;re familiar with web servers at all, you\u0026rsquo;ll recognize that this is in \u003ca href\u003d\"https://www.w3.org/Daemon/User/Config/Logging.html#common-logfile-format\"\u003eCommon Log Format\u003c/a\u003e. The fields are:\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eremotehost rfc931 authuser [date] \u0026ldquo;request\u0026rdquo; status bytes\u003c/em\u003e\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\u003cth\u003efield\u003c/th\u003e\u003cth\u003emeaning\u003c/th\u003e\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\u003ctd\u003e\u003cem\u003eremotehost\u003c/em\u003e\u003c/td\u003e\u003ctd\u003eRemote hostname (or IP number if DNS hostname is not available).\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e\u003cem\u003erfc931\u003c/em\u003e\u003c/td\u003e\u003ctd\u003eThe remote logname of the user. We don\u0026rsquo;t really care about this field.\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e\u003cem\u003eauthuser\u003c/em\u003e\u003c/td\u003e\u003ctd\u003eThe username of the remote user, as authenticated by the HTTP server.\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e\u003cem\u003e[date]\u003c/em\u003e\u003c/td\u003e\u003ctd\u003eThe date and time of the request.\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e\u003cem\u003e\u0026ldquo;request\u0026rdquo;\u003c/em\u003e\u003c/td\u003e\u003ctd\u003eThe request, exactly as it came from the browser or client.\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e\u003cem\u003estatus\u003c/em\u003e\u003c/td\u003e\u003ctd\u003eThe HTTP status code the server sent back to the client.\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e\u003cem\u003ebytes\u003c/em\u003e\u003c/td\u003e\u003ctd\u003eThe number of bytes (\u003ccode\u003eContent-Length\u003c/code\u003e) transferred to the client.\u003c/td\u003e\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eNext, we have to parse it into individual columns. We\u0026rsquo;ll use the special built-in \u003ca href\u003d\"https://spark.apache.org/docs/3.5.5/api/scala/org/apache/spark/sql/functions$.html#regexp_extract(e:org.apache.spark.sql.Column,exp:String,groupIdx:Int):org.apache.spark.sql.Column\"\u003eregexp_extract\u003c/a\u003e\u003cbr /\u003e\nfunction to do the parsing. This function matches a column against a regular expression with one or more \u003ca href\u003d\"http://regexone.com/lesson/capturing_groups\"\u003ecapture groups\u003c/a\u003e and allows you to extract one of the matched groups. We\u0026rsquo;ll use one regular expression for each field we wish to extract.\u003c/p\u003e\n\u003cp\u003eIf you can\u0026rsquo;t read these regular expressions, don\u0026rsquo;t worry. Trust us: They work. If you find regular expressions confusing (and they certainly \u003cem\u003ecan\u003c/em\u003e be), and you want to learn more about them, start with the\u003cbr /\u003e\n\u003ca href\u003d\"http://regexone.com/\"\u003eRegexOne web site\u003c/a\u003e. You might also find \u003ca href\u003d\"http://shop.oreilly.com/product/0636920023630.do\"\u003e\u003cem\u003eRegular Expressions Cookbook\u003c/em\u003e\u003c/a\u003e, by Jan Goyvaerts and Steven Levithan, to be helpful.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eSome people, when confronted with a problem, think \u0026ldquo;I know, I\u0026rsquo;ll use regular expressions.\u0026rdquo; Now they have two problems.\u003c/em\u003e (attributed to Jamie Zawinski)\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863458_1415573583",
      "id": "20180420-171534_1890534618",
      "dateCreated": "2025-03-30 13:37:43.458",
      "status": "READY"
    },
    {
      "text": "%spark\nimport org.apache.spark.sql.functions.regexp_extract",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:39:02.849",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.sql.functions.regexp_extract\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863458_1664869543",
      "id": "20180420-171542_819481712",
      "dateCreated": "2025-03-30 13:37:43.458",
      "dateStarted": "2025-03-30 13:39:02.861",
      "dateFinished": "2025-03-30 13:39:02.955",
      "status": "FINISHED"
    },
    {
      "text": "%spark\n// We use Scala multi-lines (triple-quoted) strings for the regexps to avoid having to escape\n// backslashes or double quotes.\nval hostRE        \u003d \"\"\"^([^\\s]+\\s)\"\"\"\nval timestampRE   \u003d \"\"\"^.*\\[(\\d\\d/\\w{3}/\\d{4}:\\d{2}:\\d{2}:\\d{2} -\\d{4})]\"\"\"\nval requestRE     \u003d \"\"\"^.*\"(\\w+)\\s+([^\\s]+)(\\s+.*)?\"\"\"\"\nval statusRE      \u003d \"\"\"^.*\"\\s+([^\\s]+)\"\"\"\nval contentSizeRE \u003d \"\"\"^.*\\s+(\\d+)$\"\"\"\nval splitDF \u003d baseDF.select(\n    regexp_extract($\"value\", hostRE       , 1).alias(\"host\"),\n    regexp_extract($\"value\", timestampRE  , 1).alias(\"timestamp\"),\n    regexp_extract($\"value\", requestRE    , 1).alias(\"method\"),\n    regexp_extract($\"value\", requestRE    , 2).alias(\"path\"),\n    trim(regexp_extract($\"value\", requestRE    , 3)).alias(\"protocol_version\"),\n    regexp_extract($\"value\", statusRE     , 1).cast(\"integer\").alias(\"status\"),\n    regexp_extract($\"value\", contentSizeRE, 1).cast(\"integer\").alias(\"content_size\"),\n)\nsplitDF.show(truncate \u003d false)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:39:22.695",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------------+--------------------------+------+-------------------------------------------------+----------------+------+------------+\n|host                      |timestamp                 |method|path                                             |protocol_version|status|content_size|\n+--------------------------+--------------------------+------+-------------------------------------------------+----------------+------+------------+\n|199.72.81.55              |01/Jul/1995:00:00:01 -0400|GET   |/history/apollo/                                 |HTTP/1.0        |200   |6245        |\n|unicomp6.unicomp.net      |01/Jul/1995:00:00:06 -0400|GET   |/shuttle/countdown/                              |HTTP/1.0        |200   |3985        |\n|199.120.110.21            |01/Jul/1995:00:00:09 -0400|GET   |/shuttle/missions/sts-73/mission-sts-73.html     |HTTP/1.0        |200   |4085        |\n|burger.letters.com        |01/Jul/1995:00:00:11 -0400|GET   |/shuttle/countdown/liftoff.html                  |HTTP/1.0        |304   |0           |\n|199.120.110.21            |01/Jul/1995:00:00:11 -0400|GET   |/shuttle/missions/sts-73/sts-73-patch-small.gif  |HTTP/1.0        |200   |4179        |\n|burger.letters.com        |01/Jul/1995:00:00:12 -0400|GET   |/images/NASA-logosmall.gif                       |HTTP/1.0        |304   |0           |\n|burger.letters.com        |01/Jul/1995:00:00:12 -0400|GET   |/shuttle/countdown/video/livevideo.gif           |HTTP/1.0        |200   |0           |\n|205.212.115.106           |01/Jul/1995:00:00:12 -0400|GET   |/shuttle/countdown/countdown.html                |HTTP/1.0        |200   |3985        |\n|d104.aa.net               |01/Jul/1995:00:00:13 -0400|GET   |/shuttle/countdown/                              |HTTP/1.0        |200   |3985        |\n|129.94.144.152            |01/Jul/1995:00:00:13 -0400|GET   |/                                                |HTTP/1.0        |200   |7074        |\n|unicomp6.unicomp.net      |01/Jul/1995:00:00:14 -0400|GET   |/shuttle/countdown/count.gif                     |HTTP/1.0        |200   |40310       |\n|unicomp6.unicomp.net      |01/Jul/1995:00:00:14 -0400|GET   |/images/NASA-logosmall.gif                       |HTTP/1.0        |200   |786         |\n|unicomp6.unicomp.net      |01/Jul/1995:00:00:14 -0400|GET   |/images/KSC-logosmall.gif                        |HTTP/1.0        |200   |1204        |\n|d104.aa.net               |01/Jul/1995:00:00:15 -0400|GET   |/shuttle/countdown/count.gif                     |HTTP/1.0        |200   |40310       |\n|d104.aa.net               |01/Jul/1995:00:00:15 -0400|GET   |/images/NASA-logosmall.gif                       |HTTP/1.0        |200   |786         |\n|d104.aa.net               |01/Jul/1995:00:00:15 -0400|GET   |/images/KSC-logosmall.gif                        |HTTP/1.0        |200   |1204        |\n|129.94.144.152            |01/Jul/1995:00:00:17 -0400|GET   |/images/ksclogo-medium.gif                       |HTTP/1.0        |304   |0           |\n|199.120.110.21            |01/Jul/1995:00:00:17 -0400|GET   |/images/launch-logo.gif                          |HTTP/1.0        |200   |1713        |\n|ppptky391.asahi-net.or.jp |01/Jul/1995:00:00:18 -0400|GET   |/facts/about_ksc.html                            |HTTP/1.0        |200   |3977        |\n|net-1-141.eden.com        |01/Jul/1995:00:00:19 -0400|GET   |/shuttle/missions/sts-71/images/KSC-95EC-0916.jpg|HTTP/1.0        |200   |34029       |\n+--------------------------+--------------------------+------+-------------------------------------------------+----------------+------+------------+\nonly showing top 20 rows\n\nval \u001b[1m\u001b[34mhostRE\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ^([^\\s]+\\s)\nval \u001b[1m\u001b[34mtimestampRE\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ^.*\\[(\\d\\d/\\w{3}/\\d{4}:\\d{2}:\\d{2}:\\d{2} -\\d{4})]\nval \u001b[1m\u001b[34mrequestRE\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ^.*\"(\\w+)\\s+([^\\s]+)(\\s+.*)?\"\nval \u001b[1m\u001b[34mstatusRE\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ^.*\"\\s+([^\\s]+)\nval \u001b[1m\u001b[34mcontentSizeRE\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ^.*\\s+(\\d+)$\nval \u001b[1m\u001b[34msplitDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [host: string, timestamp: string ... 5 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d3"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863458_211290998",
      "id": "20180422-210615_1476003636",
      "dateCreated": "2025-03-30 13:37:43.458",
      "dateStarted": "2025-03-30 13:39:22.706",
      "dateFinished": "2025-03-30 13:39:23.224",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (2c) Data Cleaning\n\nLet\u0027s see how well our parsing logic worked. First, let\u0027s verify that there are no null rows in the original data set.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.458",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(2c) Data Cleaning\u003c/h3\u003e\n\u003cp\u003eLet\u0026rsquo;s see how well our parsing logic worked. First, let\u0026rsquo;s verify that there are no null rows in the original data set.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863458_686692047",
      "id": "20180420-174238_1766293665",
      "dateCreated": "2025-03-30 13:37:43.458",
      "status": "READY"
    },
    {
      "text": "%spark\nval nullCount \u003d baseDF.filter(isnull($\"value\")).count()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:39:26.813",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "val \u001b[1m\u001b[34mnullCount\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d4"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d5"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863458_1287897151",
      "id": "20180420-172459_970118743",
      "dateCreated": "2025-03-30 13:37:43.458",
      "dateStarted": "2025-03-30 13:39:26.823",
      "dateFinished": "2025-03-30 13:39:28.403",
      "status": "FINISHED"
    },
    {
      "text": "%md\nIf our parsing worked properly, we\u0027ll have no rows with null column values. Let\u0027s check.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.458",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eIf our parsing worked properly, we\u0026rsquo;ll have no rows with null column values. Let\u0026rsquo;s check.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863458_1383337121",
      "id": "20180420-175046_1943162594",
      "dateCreated": "2025-03-30 13:37:43.458",
      "status": "READY"
    },
    {
      "text": "%spark\nval badRowsDF \u003d splitDF.filter(\n   $\"host\".isNull || $\"timestamp\".isNull || $\"method\".isNull || $\"path\".isNull || $\"protocol_version\".isNull  || $\"status\".isNull || $\"content_size\".isNull\n)\nval badRowsCount \u003d badRowsDF.count()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:39:29.497",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "val \u001b[1m\u001b[34mbadRowsDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [host: string, timestamp: string ... 5 more fields]\nval \u001b[1m\u001b[34mbadRowsCount\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 33904\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d6"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d7"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863458_1349211854",
      "id": "20180422-211846_248785379",
      "dateCreated": "2025-03-30 13:37:43.458",
      "dateStarted": "2025-03-30 13:39:29.514",
      "dateFinished": "2025-03-30 13:40:07.520",
      "status": "FINISHED"
    },
    {
      "text": "%md\nNot good. We have some null values. Something went wrong. Which columns are affected?\n\n(Note: This approach is adapted from an [excellent answer](http://stackoverflow.com/a/33901312) on StackOverflow.)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.459",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eNot good. We have some null values. Something went wrong. Which columns are affected?\u003c/p\u003e\n\u003cp\u003e(Note: This approach is adapted from an \u003ca href\u003d\"http://stackoverflow.com/a/33901312\"\u003eexcellent answer\u003c/a\u003e on StackOverflow.)\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863459_2041555276",
      "id": "20180421-060709_719216856",
      "dateCreated": "2025-03-30 13:37:43.459",
      "status": "READY"
    },
    {
      "text": "%spark\ndef countNull(colName: String) \u003d sum(col(colName).isNull.cast(\"integer\")).alias(colName)\nsplitDF.agg(countNull(\"host\")).show()\nsplitDF.agg(countNull(\"timestamp\")).show()\nsplitDF.agg(countNull(\"method\")).show()\nsplitDF.agg(countNull(\"path\")).show()\nsplitDF.agg(countNull(\"protocol_version\")).show()\nsplitDF.agg(countNull(\"status\")).show()\nsplitDF.agg(countNull(\"content_size\")).show()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:39:32.405",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+\n|host|\n+----+\n|   0|\n+----+\n\n+---------+\n|timestamp|\n+---------+\n|        0|\n+---------+\n\n+------+\n|method|\n+------+\n|     0|\n+------+\n\n+----+\n|path|\n+----+\n|   0|\n+----+\n\n+----------------+\n|protocol_version|\n+----------------+\n|               0|\n+----------------+\n\n+------+\n|status|\n+------+\n|     0|\n+------+\n\n+------------+\n|content_size|\n+------------+\n|       33904|\n+------------+\n\ndef countNull(colName: String): \u001b[1m\u001b[32morg.apache.spark.sql.Column\u001b[0m\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d8"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d9"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d10"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d11"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d12"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d13"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d14"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d15"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d16"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d17"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d18"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d19"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d20"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d21"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863459_536530266",
      "id": "20180420-175219_1218251765",
      "dateCreated": "2025-03-30 13:37:43.459",
      "dateStarted": "2025-03-30 13:40:07.540",
      "dateFinished": "2025-03-30 13:40:54.337",
      "status": "FINISHED"
    },
    {
      "text": "%md\nOkay, they\u0027re all in the `content_size` column. Let\u0027s see if we can figure out what\u0027s wrong. Our original parsing regular expression for that column was:\n\n```\nval contentSizeRE \u003d \"\"\"^.*\\s+(\\d+)$\"\"\"\n```\n\nThe `\\d+` selects one or more digits at the end of the input line. Is it possible there are lines without a valid content size? Or is there something wrong with our regular expression? Let\u0027s see if there are any lines that do not end with one or more digits.\n\n**Note**: In the expression below, `!` means \"not\".",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.459",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eOkay, they\u0026rsquo;re all in the \u003ccode\u003econtent_size\u003c/code\u003e column. Let\u0026rsquo;s see if we can figure out what\u0026rsquo;s wrong. Our original parsing regular expression for that column was:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eval contentSizeRE \u003d \u0026quot;\u0026quot;\u0026quot;^.*\\s+(\\d+)$\u0026quot;\u0026quot;\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe \u003ccode\u003e\\d+\u003c/code\u003e selects one or more digits at the end of the input line. Is it possible there are lines without a valid content size? Or is there something wrong with our regular expression? Let\u0026rsquo;s see if there are any lines that do not end with one or more digits.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e: In the expression below, \u003ccode\u003e!\u003c/code\u003e means \u0026ldquo;not\u0026rdquo;.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863459_1793186760",
      "id": "20180421-152104_34949968",
      "dateCreated": "2025-03-30 13:37:43.459",
      "status": "READY"
    },
    {
      "text": "%spark\nval badContentSizeDF \u003d baseDF.filter( ! $\"value\".rlike(\"\"\"\\d+$\"\"\"))\nval badContentSizeCount \u003d badContentSizeDF.count()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:41:03.983",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "val \u001b[1m\u001b[34mbadContentSizeDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [value: string]\nval \u001b[1m\u001b[34mbadContentSizeCount\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 33904\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d22"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d23"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863459_470550633",
      "id": "20180421-061313_365753858",
      "dateCreated": "2025-03-30 13:37:43.459",
      "dateStarted": "2025-03-30 13:41:03.997",
      "dateFinished": "2025-03-30 13:41:11.312",
      "status": "FINISHED"
    },
    {
      "text": "%md\nThat\u0027s it! The count matches the number of rows in `badRowsDF` exactly.\n\nLet\u0027s take a look at some of the bad column values. Since it\u0027s possible that the rows end in extra white space, we\u0027ll tack a marker character onto the end of each line, to make it easier to see trailing white space.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.459",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eThat\u0026rsquo;s it! The count matches the number of rows in \u003ccode\u003ebadRowsDF\u003c/code\u003e exactly.\u003c/p\u003e\n\u003cp\u003eLet\u0026rsquo;s take a look at some of the bad column values. Since it\u0026rsquo;s possible that the rows end in extra white space, we\u0026rsquo;ll tack a marker character onto the end of each line, to make it easier to see trailing white space.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863459_928192449",
      "id": "20180421-154705_24309116",
      "dateCreated": "2025-03-30 13:37:43.459",
      "status": "READY"
    },
    {
      "text": "%spark\nimport org.apache.spark.sql.functions.lit\nbadContentSizeDF.select(concat(badContentSizeDF(\"value\"), lit(\"*\"))).show(truncate \u003d false)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:41:16.642",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---------------------------------------------------------------------------------------------------------------------------------------------------+\n|concat(value, *)                                                                                                                                   |\n+---------------------------------------------------------------------------------------------------------------------------------------------------+\n|dd15-062.compuserve.com - - [01/Jul/1995:00:01:12 -0400] \"GET /news/sci.space.shuttle/archive/sci-space-shuttle-22-apr-1995-40.txt HTTP/1.0\" 404 -*|\n|dynip42.efn.org - - [01/Jul/1995:00:02:14 -0400] \"GET /software HTTP/1.0\" 302 -*                                                                   |\n|ix-or10-06.ix.netcom.com - - [01/Jul/1995:00:02:40 -0400] \"GET /software/winvn HTTP/1.0\" 302 -*                                                    |\n|ix-or10-06.ix.netcom.com - - [01/Jul/1995:00:03:24 -0400] \"GET /software HTTP/1.0\" 302 -*                                                          |\n|link097.txdirect.net - - [01/Jul/1995:00:05:06 -0400] \"GET /shuttle HTTP/1.0\" 302 -*                                                               |\n|ix-war-mi1-20.ix.netcom.com - - [01/Jul/1995:00:05:13 -0400] \"GET /shuttle/missions/sts-78/news HTTP/1.0\" 302 -*                                   |\n|ix-war-mi1-20.ix.netcom.com - - [01/Jul/1995:00:05:58 -0400] \"GET /shuttle/missions/sts-72/news HTTP/1.0\" 302 -*                                   |\n|netport-27.iu.net - - [01/Jul/1995:00:10:19 -0400] \"GET /pub/winvn/readme.txt HTTP/1.0\" 404 -*                                                     |\n|netport-27.iu.net - - [01/Jul/1995:00:10:28 -0400] \"GET /pub/winvn/readme.txt HTTP/1.0\" 404 -*                                                     |\n|dynip38.efn.org - - [01/Jul/1995:00:10:50 -0400] \"GET /software HTTP/1.0\" 302 -*                                                                   |\n|129.188.154.200 - - [01/Jul/1995:00:11:14 -0400] \"GET /shuttle/missions HTTP/1.0\" 302 -*                                                           |\n|129.188.154.200 - - [01/Jul/1995:00:11:35 -0400] \"GET /shuttle HTTP/1.0\" 302 -*                                                                    |\n|129.188.154.200 - - [01/Jul/1995:00:12:51 -0400] \"GET /shuttle HTTP/1.0\" 302 -*                                                                    |\n|blv-pm0-ip28.halcyon.com - - [01/Jul/1995:00:14:17 -0400] \"GET /persons/astronauts/i-to-l/lousmaJR.txt HTTP/1.0\" 404 -*                            |\n|blv-pm0-ip28.halcyon.com - - [01/Jul/1995:00:14:32 -0400] \"GET /persons/astronauts/a-to-d/beanAL.txt HTTP/1.0\" 404 -*                              |\n|detroit.freenet.org - - [01/Jul/1995:00:16:10 -0400] \"GET /shuttle/countdown HTTP/1.0\" 302 -*                                                      |\n|news.ti.com - - [01/Jul/1995:00:17:19 -0400] \"GET /shuttle/missions/sts-71/news HTTP/1.0\" 302 -*                                                   |\n|cu-dialup-1005.cit.cornell.edu - - [01/Jul/1995:00:18:39 -0400] \"GET /pub/winvn/readme.txt HTTP/1.0\" 404 -*                                        |\n|cu-dialup-1005.cit.cornell.edu - - [01/Jul/1995:00:18:45 -0400] \"GET /pub/winvn/readme.txt HTTP/1.0\" 404 -*                                        |\n|cu-dialup-1005.cit.cornell.edu - - [01/Jul/1995:00:18:49 -0400] \"GET /pub/winvn/release.txt HTTP/1.0\" 404 -*                                       |\n+---------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.sql.functions.lit\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d24"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863459_1311537636",
      "id": "20180421-154733_2007994697",
      "dateCreated": "2025-03-30 13:37:43.459",
      "dateStarted": "2025-03-30 13:41:16.653",
      "dateFinished": "2025-03-30 13:41:16.870",
      "status": "FINISHED"
    },
    {
      "text": "%md\nAh. The bad rows correspond to error results, where no content was sent back and the server emitted a \"`-`\" for the `content_size` field. Since we don\u0027t want to discard those rows from our analysis, let\u0027s map them to 0.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.459",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eAh. The bad rows correspond to error results, where no content was sent back and the server emitted a \u0026ldquo;\u003ccode\u003e-\u003c/code\u003e\u0026rdquo; for the \u003ccode\u003econtent_size\u003c/code\u003e field. Since we don\u0026rsquo;t want to discard those rows from our analysis, let\u0026rsquo;s map them to 0.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863459_1583135658",
      "id": "20180421-152330_1654204590",
      "dateCreated": "2025-03-30 13:37:43.459",
      "status": "READY"
    },
    {
      "text": "%md\n### (2d) Fix the rows with null content\\_size\n\nThe easiest solution is to replace the null values in `splitDF` with 0. The DataFrame API provides a set of functions and fields specifically designed for working with null values in the `.na` subpackage of a DataFrame: [na](https://spark.apache.org/docs/3.5.1/api/scala/org/apache/spark/sql/Dataset.html#na:org.apache.spark.sql.DataFrameNaFunctions) on a DataFrame returns a [DataFrameNaFunctions](https://spark.apache.org/docs/3.5.1/api/scala/org/apache/spark/sql/DataFrameNaFunctions.html) object with many functions for operating on null columns.\n\nWe\u0027ll use the `fill` function. There are several ways to invoke this function. The easiest is just to replace _all_ null columns with known values. But, for safety, it\u0027s better to pass a Scala Map containing (column\\_name, value) mappings. That\u0027s what we\u0027ll do.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.459",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(2d) Fix the rows with null content_size\u003c/h3\u003e\n\u003cp\u003eThe easiest solution is to replace the null values in \u003ccode\u003esplitDF\u003c/code\u003e with 0. The DataFrame API provides a set of functions and fields specifically designed for working with null values in the \u003ccode\u003e.na\u003c/code\u003e subpackage of a DataFrame: \u003ca href\u003d\"https://spark.apache.org/docs/3.5.1/api/scala/org/apache/spark/sql/Dataset.html#na:org.apache.spark.sql.DataFrameNaFunctions\"\u003ena\u003c/a\u003e on a DataFrame returns a \u003ca href\u003d\"https://spark.apache.org/docs/3.5.1/api/scala/org/apache/spark/sql/DataFrameNaFunctions.html\"\u003eDataFrameNaFunctions\u003c/a\u003e object with many functions for operating on null columns.\u003c/p\u003e\n\u003cp\u003eWe\u0026rsquo;ll use the \u003ccode\u003efill\u003c/code\u003e function. There are several ways to invoke this function. The easiest is just to replace \u003cem\u003eall\u003c/em\u003e null columns with known values. But, for safety, it\u0026rsquo;s better to pass a Scala Map containing (column_name, value) mappings. That\u0026rsquo;s what we\u0026rsquo;ll do.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863459_1552543838",
      "id": "20180421-152222_1862522022",
      "dateCreated": "2025-03-30 13:37:43.459",
      "status": "READY"
    },
    {
      "text": "%spark\n// Replace all null content_size values with 0.\nval cleanedDF \u003d splitDF.na.fill(Map(\"content_size\" -\u003e 0))",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:41:19.889",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "val \u001b[1m\u001b[34mcleanedDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [host: string, timestamp: string ... 5 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863459_239445381",
      "id": "20180421-152222_1231110223",
      "dateCreated": "2025-03-30 13:37:43.459",
      "dateStarted": "2025-03-30 13:41:19.900",
      "dateFinished": "2025-03-30 13:41:20.006",
      "status": "FINISHED"
    },
    {
      "text": "%spark\n// Ensure that there are no nulls left.\n\nval exprs \u003d cleanedDF.columns.map( colName \u003d\u003e countNull(colName) ).toSeq\n// The splat operator (: _*) convert a collection into a repeated parameter. For example, with def func(params: Int*), the following val lst \u003d List(1, 2); func(lst:_*) is equivalent to func(1, 2) \ncleanedDF.agg(exprs.head, exprs.tail : _*).show()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:41:22.522",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+---------+------+----+----------------+------+------------+\n|host|timestamp|method|path|protocol_version|status|content_size|\n+----+---------+------+----+----------------+------+------------+\n|   0|        0|     0|   0|               0|     0|           0|\n+----+---------+------+----+----------------+------+------------+\n\nval \u001b[1m\u001b[34mexprs\u001b[0m: \u001b[1m\u001b[32mSeq[org.apache.spark.sql.Column]\u001b[0m \u003d ArraySeq(sum(CAST((host IS NULL) AS INT)) AS host, sum(CAST((timestamp IS NULL) AS INT)) AS timestamp, sum(CAST((method IS NULL) AS INT)) AS method, sum(CAST((path IS NULL) AS INT)) AS path, sum(CAST((protocol_version IS NULL) AS INT)) AS protocol_version, sum(CAST((status IS NULL) AS INT)) AS status, sum(CAST((content_size IS NULL) AS INT)) AS content_size)\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d25"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d26"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863459_1105464222",
      "id": "20180421-152604_2009528453",
      "dateCreated": "2025-03-30 13:37:43.459",
      "dateStarted": "2025-03-30 13:41:22.533",
      "dateFinished": "2025-03-30 13:41:55.204",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (2e) Parsing the timestamp.\n\nOkay, now that we have a clean, parsed DataFrame, we have to parse the timestamp field into an actual timestamp. The Common Log Format time is somewhat non-standard. A User-Defined Function (UDF) is the most straightforward way to parse it.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.460",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(2e) Parsing the timestamp.\u003c/h3\u003e\n\u003cp\u003eOkay, now that we have a clean, parsed DataFrame, we have to parse the timestamp field into an actual timestamp. The Common Log Format time is somewhat non-standard. A User-Defined Function (UDF) is the most straightforward way to parse it.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863460_1157760969",
      "id": "20180421-154538_1087334655",
      "dateCreated": "2025-03-30 13:37:43.460",
      "status": "READY"
    },
    {
      "text": "%spark\nval monthMap \u003d Map(\n    \"Jan\" -\u003e  1, \"Feb\" -\u003e  2, \"Mar\" -\u003e  3, \"Apr\" -\u003e  4, \"May\" -\u003e  5, \"Jun\" -\u003e  6,\n    \"Jul\" -\u003e  7, \"Aug\" -\u003e  8, \"Sep\" -\u003e  9, \"Oct\" -\u003e 10, \"Nov\" -\u003e 11, \"Dec\" -\u003e 12\n)\n\ndef parseClfTime(s: String) \u003d {\n    val year   \u003d s.substring(7, 11).toInt\n    val month  \u003d monthMap(s.substring(3, 6))\n    val day    \u003d s.substring(0, 2).toInt\n    val hour   \u003d s.substring(12, 14).toInt\n    val minute \u003d s.substring(15, 17).toInt\n    val second \u003d s.substring(18, 20).toInt\n    f\"$year%04d-$month%02d-$day%02d $hour%02d:$minute%02d:$second%02d\"\n}\n\nval u_parse_time \u003d sqlContext.udf.register(\"u_parse_time\", parseClfTime _)\nval logsDF \u003d cleanedDF.select(\n    $\"host\",\n    u_parse_time($\"timestamp\").cast(\"timestamp\").as(\"time\"),\n    $\"path\",\n    $\"status\",\n    $\"content_size\"\n)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:42:05.167",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {
          "1": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300.0,
              "optionOpen": true,
              "setting": {
                "multiBarChart": {}
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "time",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "host",
                  "index": 0.0,
                  "aggr": "count"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "val \u001b[1m\u001b[34mmonthMap\u001b[0m: \u001b[1m\u001b[32mscala.collection.immutable.Map[String,Int]\u001b[0m \u003d HashMap(Nov -\u003e 11, Jul -\u003e 7, Oct -\u003e 10, Dec -\u003e 12, Feb -\u003e 2, May -\u003e 5, Apr -\u003e 4, Aug -\u003e 8, Sep -\u003e 9, Jun -\u003e 6, Mar -\u003e 3, Jan -\u003e 1)\ndef parseClfTime(s: String): \u001b[1m\u001b[32mString\u001b[0m\nval \u001b[1m\u001b[34mu_parse_time\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.UserDefinedFunction\u001b[0m \u003d SparkUserDefinedFunction($Lambda$4345/0x00000008417d5040@54dc2ee1,StringType,List(Some(class[value[0]: string])),Some(class[value[0]: string]),Some(u_parse_time),true,true)\nval \u001b[1m\u001b[34mlogsDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [host: string, time: timestamp ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863460_1467926233",
      "id": "20180421-152748_1608028379",
      "dateCreated": "2025-03-30 13:37:43.460",
      "dateStarted": "2025-03-30 13:42:05.179",
      "dateFinished": "2025-03-30 13:42:05.568",
      "status": "FINISHED"
    },
    {
      "text": "%spark\nlogsDF.printSchema()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:42:13.560",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- host: string (nullable \u003d true)\n |-- time: timestamp (nullable \u003d true)\n |-- path: string (nullable \u003d true)\n |-- status: integer (nullable \u003d true)\n |-- content_size: integer (nullable \u003d false)\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863460_1991894890",
      "id": "20180421-164637_1665778235",
      "dateCreated": "2025-03-30 13:37:43.460",
      "dateStarted": "2025-03-30 13:42:13.571",
      "dateFinished": "2025-03-30 13:42:13.667",
      "status": "FINISHED"
    },
    {
      "text": "%spark\nlogsDF.show()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:42:16.742",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+-------------------+--------------------+------+------------+\n|                host|               time|                path|status|content_size|\n+--------------------+-------------------+--------------------+------+------------+\n|       199.72.81.55 |1995-07-01 00:00:01|    /history/apollo/|   200|        6245|\n|unicomp6.unicomp....|1995-07-01 00:00:06| /shuttle/countdown/|   200|        3985|\n|     199.120.110.21 |1995-07-01 00:00:09|/shuttle/missions...|   200|        4085|\n| burger.letters.com |1995-07-01 00:00:11|/shuttle/countdow...|   304|           0|\n|     199.120.110.21 |1995-07-01 00:00:11|/shuttle/missions...|   200|        4179|\n| burger.letters.com |1995-07-01 00:00:12|/images/NASA-logo...|   304|           0|\n| burger.letters.com |1995-07-01 00:00:12|/shuttle/countdow...|   200|           0|\n|    205.212.115.106 |1995-07-01 00:00:12|/shuttle/countdow...|   200|        3985|\n|        d104.aa.net |1995-07-01 00:00:13| /shuttle/countdown/|   200|        3985|\n|     129.94.144.152 |1995-07-01 00:00:13|                   /|   200|        7074|\n|unicomp6.unicomp....|1995-07-01 00:00:14|/shuttle/countdow...|   200|       40310|\n|unicomp6.unicomp....|1995-07-01 00:00:14|/images/NASA-logo...|   200|         786|\n|unicomp6.unicomp....|1995-07-01 00:00:14|/images/KSC-logos...|   200|        1204|\n|        d104.aa.net |1995-07-01 00:00:15|/shuttle/countdow...|   200|       40310|\n|        d104.aa.net |1995-07-01 00:00:15|/images/NASA-logo...|   200|         786|\n|        d104.aa.net |1995-07-01 00:00:15|/images/KSC-logos...|   200|        1204|\n|     129.94.144.152 |1995-07-01 00:00:17|/images/ksclogo-m...|   304|           0|\n|     199.120.110.21 |1995-07-01 00:00:17|/images/launch-lo...|   200|        1713|\n|ppptky391.asahi-n...|1995-07-01 00:00:18|/facts/about_ksc....|   200|        3977|\n| net-1-141.eden.com |1995-07-01 00:00:19|/shuttle/missions...|   200|       34029|\n+--------------------+-------------------+--------------------+------+------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d27"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863460_1125062921",
      "id": "20180421-164603_76819419",
      "dateCreated": "2025-03-30 13:37:43.460",
      "dateStarted": "2025-03-30 13:42:16.759",
      "dateFinished": "2025-03-30 13:42:17.138",
      "status": "FINISHED"
    },
    {
      "text": "%md\nLet\u0027s cache `logsDF`. We\u0027re going to be using it quite a bit from here forward.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.460",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eLet\u0026rsquo;s cache \u003ccode\u003elogsDF\u003c/code\u003e. We\u0026rsquo;re going to be using it quite a bit from here forward.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863460_566140797",
      "id": "20180421-164726_630292021",
      "dateCreated": "2025-03-30 13:37:43.460",
      "status": "READY"
    },
    {
      "text": "%spark\nlogsDF.cache()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:42:29.213",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "val \u001b[1m\u001b[34mres9\u001b[0m: \u001b[1m\u001b[32mlogsDF.type\u001b[0m \u003d [host: string, time: timestamp ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863460_88998780",
      "id": "20180421-155813_1819928061",
      "dateCreated": "2025-03-30 13:37:43.460",
      "dateStarted": "2025-03-30 13:42:29.223",
      "dateFinished": "2025-03-30 13:42:29.349",
      "status": "FINISHED"
    },
    {
      "text": "%md\n## Part 3: Analysis Walk-Through on the Web Server Log File\n\nNow that we have a DataFrame containing the parsed log file as a set of Row objects, we can perform various analyses.\n\n### (3a) Example: Content Size Statistics\n\nLet\u0027s compute some statistics about the sizes of content being returned by the web server. In particular, we\u0027d like to know what are the average, minimum, and maximum content sizes.\n\nWe can compute the statistics by calling `.describe` on the `content_size` column of `logsDF`.  The `.describe` function returns the count, mean, stddev, min, and max of a given column.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.460",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003ePart 3: Analysis Walk-Through on the Web Server Log File\u003c/h2\u003e\n\u003cp\u003eNow that we have a DataFrame containing the parsed log file as a set of Row objects, we can perform various analyses.\u003c/p\u003e\n\u003ch3\u003e(3a) Example: Content Size Statistics\u003c/h3\u003e\n\u003cp\u003eLet\u0026rsquo;s compute some statistics about the sizes of content being returned by the web server. In particular, we\u0026rsquo;d like to know what are the average, minimum, and maximum content sizes.\u003c/p\u003e\n\u003cp\u003eWe can compute the statistics by calling \u003ccode\u003e.describe\u003c/code\u003e on the \u003ccode\u003econtent_size\u003c/code\u003e column of \u003ccode\u003elogsDF\u003c/code\u003e.  The \u003ccode\u003e.describe\u003c/code\u003e function returns the count, mean, stddev, min, and max of a given column.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863460_1187879162",
      "id": "20180421-164758_2004619347",
      "dateCreated": "2025-03-30 13:37:43.460",
      "status": "READY"
    },
    {
      "text": "%spark\n// Calculate statistics based on the content size.\nval contentSizeSummaryDF \u003d logsDF.describe(\"content_size\")\ncontentSizeSummaryDF.show()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:42:37.352",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+\n|summary|      content_size|\n+-------+------------------+\n|  count|           3461612|\n|   mean|18928.844398216785|\n| stddev| 73031.47260949216|\n|    min|                 0|\n|    max|           6823936|\n+-------+------------------+\n\nval \u001b[1m\u001b[34mcontentSizeSummaryDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [summary: string, content_size: string]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d28"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d29"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d30"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863460_1529014198",
      "id": "20180421-164839_1628646938",
      "dateCreated": "2025-03-30 13:37:43.461",
      "dateStarted": "2025-03-30 13:42:37.363",
      "dateFinished": "2025-03-30 13:43:18.756",
      "status": "FINISHED"
    },
    {
      "text": "%md\nAlternatively, we can use SQL to directly calculate these statistics.  You can explore the many useful functions within the `org.apache.spark.sql.functions` module in the [documentation](https://spark.apache.org/docs/3.5.5/api/scala/org/apache/spark/sql/functions$.html).\n\nAfter we apply the `.agg()` function, we call `.first()` to extract the first row, which is equivalent to `.take(1)`, then we call `.get(0)` to get the first value of the row.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.461",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eAlternatively, we can use SQL to directly calculate these statistics.  You can explore the many useful functions within the \u003ccode\u003eorg.apache.spark.sql.functions\u003c/code\u003e module in the \u003ca href\u003d\"https://spark.apache.org/docs/3.5.5/api/scala/org/apache/spark/sql/functions$.html\"\u003edocumentation\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eAfter we apply the \u003ccode\u003e.agg()\u003c/code\u003e function, we call \u003ccode\u003e.first()\u003c/code\u003e to extract the first row, which is equivalent to \u003ccode\u003e.take(1)\u003c/code\u003e, then we call \u003ccode\u003e.get(0)\u003c/code\u003e to get the first value of the row.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863461_54941371",
      "id": "20180421-165049_978544457",
      "dateCreated": "2025-03-30 13:37:43.461",
      "status": "READY"
    },
    {
      "text": "%spark\nval minContentSize \u003d logsDF.agg(min($\"content_size\")).first().get(0)\nval avgContentSize \u003d logsDF.agg(avg($\"content_size\")).first().get(0)\nval maxContentSize \u003d logsDF.agg(max($\"content_size\")).first().get(0)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:43:27.999",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "val \u001b[1m\u001b[34mminContentSize\u001b[0m: \u001b[1m\u001b[32mAny\u001b[0m \u003d 0\nval \u001b[1m\u001b[34mavgContentSize\u001b[0m: \u001b[1m\u001b[32mAny\u001b[0m \u003d 18928.844398216785\nval \u001b[1m\u001b[34mmaxContentSize\u001b[0m: \u001b[1m\u001b[32mAny\u001b[0m \u003d 6823936\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d31"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d32"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d33"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d34"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d35"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d36"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863461_1907019075",
      "id": "20180421-165010_997807986",
      "dateCreated": "2025-03-30 13:37:43.461",
      "dateStarted": "2025-03-30 13:43:28.010",
      "dateFinished": "2025-03-30 13:43:28.901",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (3b) Example: HTTP Status Analysis\n\nNext, let\u0027s look at the status values that appear in the log. We want to know which status values appear in the data and how many times.  We again start with `logsDF`, then group by the `status` column, apply the `.count()` aggregation function, and sort by the `status` column.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.461",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(3b) Example: HTTP Status Analysis\u003c/h3\u003e\n\u003cp\u003eNext, let\u0026rsquo;s look at the status values that appear in the log. We want to know which status values appear in the data and how many times.  We again start with \u003ccode\u003elogsDF\u003c/code\u003e, then group by the \u003ccode\u003estatus\u003c/code\u003e column, apply the \u003ccode\u003e.count()\u003c/code\u003e aggregation function, and sort by the \u003ccode\u003estatus\u003c/code\u003e column.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863461_646315910",
      "id": "20180421-170709_618202903",
      "dateCreated": "2025-03-30 13:37:43.461",
      "status": "READY"
    },
    {
      "text": "%spark\nval statusToCountDF \u003d logsDF\n    .groupBy(\"status\")\n    .count()\n    .sort(\"status\")\n    .cache()\nval statusToCountLength \u003d statusToCountDF.count()\nprintln(s\"Found $statusToCountLength distinct status codes\")\nstatusToCountDF.show()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:43:35.703",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Found 8 distinct status codes\n+------+-------+\n|status|  count|\n+------+-------+\n|   200|3100522|\n|   302|  73070|\n|   304| 266773|\n|   400|     15|\n|   403|    225|\n|   404|  20901|\n|   500|     65|\n|   501|     41|\n+------+-------+\n\nval \u001b[1m\u001b[34mstatusToCountDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [status: int, count: bigint]\nval \u001b[1m\u001b[34mstatusToCountLength\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 8\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d37"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d38"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d39"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d40"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d41"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d42"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d43"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863461_1641535599",
      "id": "20180421-165458_1391998400",
      "dateCreated": "2025-03-30 13:37:43.461",
      "dateStarted": "2025-03-30 13:43:35.713",
      "dateFinished": "2025-03-30 13:43:36.789",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (3c) Example: Status Graphing\n\nNow, let\u0027s visualize the results from the last example.  We can use the built-in `z.show(dataframe)` helper to show a bar chart of the count for each response code.  After running this cell, select the bar graph icon, and then use \"settings\" and drag `status` to the __Keys__ entry field and drag `count` to the __Values__ entry field.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.461",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(3c) Example: Status Graphing\u003c/h3\u003e\n\u003cp\u003eNow, let\u0026rsquo;s visualize the results from the last example.  We can use the built-in \u003ccode\u003ez.show(dataframe)\u003c/code\u003e helper to show a bar chart of the count for each response code.  After running this cell, select the bar graph icon, and then use \u0026ldquo;settings\u0026rdquo; and drag \u003ccode\u003estatus\u003c/code\u003e to the \u003cstrong\u003eKeys\u003c/strong\u003e entry field and drag \u003ccode\u003ecount\u003c/code\u003e to the \u003cstrong\u003eValues\u003c/strong\u003e entry field.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863461_630926813",
      "id": "20180421-171255_1596094993",
      "dateCreated": "2025-03-30 13:37:43.461",
      "status": "READY"
    },
    {
      "text": "%spark\nz.show(statusToCountDF)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:43:40.368",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {
          "0": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default",
                  "stacked": false
                },
                "lineChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default",
                  "forceY": false,
                  "lineWithFocus": false,
                  "isDateFormat": false,
                  "dateFormat": ""
                },
                "stackedAreaChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default",
                  "style": "stack"
                },
                "scatterChart": {}
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "status",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "count",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ]
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "status\tcount\n200\t3100522\n302\t73070\n304\t266773\n400\t15\n403\t225\n404\t20901\n500\t65\n501\t41\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d44"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863461_1303169775",
      "id": "20180421-170910_1978521381",
      "dateCreated": "2025-03-30 13:37:43.461",
      "dateStarted": "2025-03-30 13:43:40.379",
      "dateFinished": "2025-03-30 13:43:40.594",
      "status": "FINISHED"
    },
    {
      "text": "%md\nYou can see that this is not a very effective plot.  Due to the large number of \u0027200\u0027 codes, it is very hard to see the relative number of the others.  We can alleviate this by taking the logarithm of the count, adding that as a column to our DataFrame and displaying the result.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.461",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eYou can see that this is not a very effective plot.  Due to the large number of \u0026lsquo;200\u0026rsquo; codes, it is very hard to see the relative number of the others.  We can alleviate this by taking the logarithm of the count, adding that as a column to our DataFrame and displaying the result.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863461_458051347",
      "id": "20180421-171626_431287929",
      "dateCreated": "2025-03-30 13:37:43.461",
      "status": "READY"
    },
    {
      "text": "%spark\nval logStatusToCountDF \u003d statusToCountDF\n    .withColumn(\"log(count)\", log($\"count\"))\n\nz.show(logStatusToCountDF)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:43:43.790",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {
          "0": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "status": "string",
                      "count": "string",
                      "log(count)": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "status",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "log(count)",
                  "index": 2.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          },
          "1": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "status",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "log(count)",
                  "index": 2.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "status\tcount\tlog(count)\n200\t3100522\t14.947081042376633\n302\t73070\t11.199173164785263\n304\t266773\t12.494153388502301\n400\t15\t2.70805020110221\n403\t225\t5.41610040220442\n404\t20901\t9.94755228369823\n500\t65\t4.174387269895637\n501\t41\t3.713572066704308\n"
          },
          {
            "type": "TEXT",
            "data": "val \u001b[1m\u001b[34mlogStatusToCountDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [status: int, count: bigint ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d45"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863461_729303130",
      "id": "20180421-171401_815455227",
      "dateCreated": "2025-03-30 13:37:43.461",
      "dateStarted": "2025-03-30 13:43:43.807",
      "dateFinished": "2025-03-30 13:43:44.042",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (3d) Example: Frequent Hosts\n\nLet\u0027s look at hosts that have accessed the server frequently (e.g., more than ten times). As with the response code analysis in (3b), we create a new DataFrame by grouping `successLogsDF` by the \u0027host\u0027 column and aggregating by count.\n\nWe then filter the result based on the count of accesses by each host being greater than ten.  Then, we select the \u0027host\u0027 column and show 20 elements from the result.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.462",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(3d) Example: Frequent Hosts\u003c/h3\u003e\n\u003cp\u003eLet\u0026rsquo;s look at hosts that have accessed the server frequently (e.g., more than ten times). As with the response code analysis in (3b), we create a new DataFrame by grouping \u003ccode\u003esuccessLogsDF\u003c/code\u003e by the \u0026lsquo;host\u0026rsquo; column and aggregating by count.\u003c/p\u003e\n\u003cp\u003eWe then filter the result based on the count of accesses by each host being greater than ten.  Then, we select the \u0026lsquo;host\u0026rsquo; column and show 20 elements from the result.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863462_281666131",
      "id": "20180421-172051_1826487943",
      "dateCreated": "2025-03-30 13:37:43.462",
      "status": "READY"
    },
    {
      "text": "%spark\n// Any hosts that have accessed the server more than 10 times.\nval hostSumDF \u003d logsDF\n    .groupBy(\"host\")\n    .count()\n\nval hostMoreThan10DF \u003d hostSumDF\n    .filter($\"count\" \u003e 10)\n    .select($\"host\")\n\nprintln(\"Any 20 hosts that have accessed more than 10 times:\")\nhostMoreThan10DF.show(truncate \u003d false)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:43:46.482",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "host": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Any 20 hosts that have accessed more than 10 times:\n+----------------------------+\n|host                        |\n+----------------------------+\n|picard.microsys.net         |\n|ts900-418.singnet.com.sg    |\n|winnie.freenet.mb.ca        |\n|alpha2.csd.uwm.edu          |\n|ivy-b0.aip.realtime.net     |\n|maria-4e.ip.realtime.net    |\n|kauai-9.u.aloha.net         |\n|edinburgh3.easynet.co.uk    |\n|192.127.29.43               |\n|st2158.infonet.tufts.edu    |\n|moe06.slip.yorku.ca         |\n|lcy-ip19.halcyon.com        |\n|pm1-orl7.iag.net            |\n|dd08-044.compuserve.com     |\n|146.154.26.105              |\n|nrba1_onlink9.onlink.net    |\n|drjo006a168.embratel.net.br |\n|grail606.nando.net          |\n|dd04-016.compuserve.com     |\n|134.157.11.7                |\n+----------------------------+\nonly showing top 20 rows\n\nval \u001b[1m\u001b[34mhostSumDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [host: string, count: bigint]\nval \u001b[1m\u001b[34mhostMoreThan10DF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [host: string]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d46"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d47"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863462_253367880",
      "id": "20180421-171912_738391104",
      "dateCreated": "2025-03-30 13:37:43.462",
      "dateStarted": "2025-03-30 13:43:46.492",
      "dateFinished": "2025-03-30 13:43:48.074",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (3e) Example: Visualizing Paths\n\nNow, let\u0027s visualize the number of hits to paths (URIs) in the log. To perform this task, we start with our `logsDF` and group by the `path` column, aggregate by count, and sort in descending order.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.462",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(3e) Example: Visualizing Paths\u003c/h3\u003e\n\u003cp\u003eNow, let\u0026rsquo;s visualize the number of hits to paths (URIs) in the log. To perform this task, we start with our \u003ccode\u003elogsDF\u003c/code\u003e and group by the \u003ccode\u003epath\u003c/code\u003e column, aggregate by count, and sort in descending order.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863462_48580558",
      "id": "20180421-172640_2039423721",
      "dateCreated": "2025-03-30 13:37:43.462",
      "status": "READY"
    },
    {
      "text": "%spark\nval pathsDF \u003d logsDF\n    .groupBy(\"path\")\n    .count()\n    .sort(desc(\"count\"))\nz.show(pathsDF)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:44:43.078",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "path": "string",
                      "count": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          },
          "1": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "path",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "count",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "path\tcount\n/images/NASA-logosmall.gif\t208798\n/images/KSC-logosmall.gif\t164976\n/images/MOSAIC-logosmall.gif\t127916\n/images/USA-logosmall.gif\t127082\n/images/WORLD-logosmall.gif\t125933\n/images/ksclogo-medium.gif\t121580\n/ksc.html\t83918\n/images/launch-logo.gif\t76009\n/history/apollo/images/apollo-logo1.gif\t68898\n/shuttle/countdown/\t64740\n/\t63257\n/images/ksclogosmall.gif\t61395\n/shuttle/missions/missions.html\t47318\n/images/launchmedium.gif\t40689\n/htbin/cdt_main.pl\t39873\n/shuttle/missions/sts-69/mission-sts-69.html\t31574\n/shuttle/countdown/liftoff.html\t29865\n/icons/menu.xbm\t29190\n/shuttle/missions/sts-69/sts-69-patch-small.gif\t29119\n/icons/blank.xbm\t28852\n/history/apollo/images/footprint-logo.gif\t26301\n/shuttle/missions/sts-71/sts-71-patch-small.gif\t25466\n/shuttle/missions/sts-69/count69.gif\t24383\n/history/apollo/apollo.html\t23457\n/history/apollo/images/footprint-small.gif\t23150\n/shuttle/missions/sts-70/sts-70-patch-small.gif\t22950\n/icons/image.xbm\t22456\n/shuttle/countdown/count.gif\t22237\n/history/history.html\t21952\n/shuttle/countdown/count70.gif\t21417\n/htbin/cdt_clock.pl\t21150\n/history/apollo/apollo-13/apollo-13.html\t20945\n/shuttle/missions/sts-70/mission-sts-70.html\t20189\n/shuttle/missions/sts-71/mission-sts-71.html\t19847\n/history/apollo/images/apollo-small.gif\t19534\n/history/apollo/apollo-13/apollo-13-patch-small.gif\t19323\n/shuttle/missions/sts-71/images/images.html\t18842\n/software/winvn/winvn.html\t17315\n/shuttle/countdown/video/livevideo2.gif\t16856\n/shuttle/resources/orbiters/orbiters-logo.gif\t15934\n/shuttle/countdown/images/countclock.gif\t15347\n/software/winvn/winvn.gif\t15133\n/icons/text.xbm\t15106\n/software/winvn/wvsmall.gif\t14533\n/software/winvn/bluemarb.gif\t14424\n/images/shuttle-patch-logo.gif\t14298\n/shuttle/technology/sts-newsref/stsref-toc.html\t13938\n/images/kscmap-tiny.gif\t13535\n/history/apollo/images/apollo-logo.gif\t12733\n/images/construct.gif\t12140\n/shuttle/countdown/countdown.html\t12090\n/images/\t11729\n/shuttle/countdown/video/livevideo.jpeg\t11076\n/images/shuttle-patch-small.gif\t10222\n/shuttle/countdown/video/livevideo.gif\t10168\n/shuttle/missions/sts-71/movies/movies.html\t9816\n/shuttle/missions/sts-70/images/images.html\t9800\n/facilities/lc39a.html\t9724\n/images/lc39a-logo.gif\t8701\n/shuttle/countdown/images/cdtclock.gif\t8668\n/history/apollo/apollo-11/apollo-11.html\t8144\n/shuttle/missions/sts-70/movies/movies.html\t7917\n/icons/unknown.xbm\t7714\n/history/apollo/apollo-13/apollo-13-info.html\t7616\n/shuttle/technology/sts-newsref/sts_asm.html\t6910\n/history/apollo/apollo-11/apollo-11-patch-small.gif\t6895\n/shuttle/resources/orbiters/endeavour.html\t6752\n/shuttle/technology/images/srb_mod_compare_1-small.gif\t6285\n/shuttle/countdown/lps/fr.html\t6126\n/shuttle/technology/images/srb_mod_compare_3-small.gif\t6117\n/shuttle/resources/orbiters/endeavour-logo.gif\t5857\n/shuttle/technology/images/srb_mod_compare_6-small.gif\t5853\n/shuttle/missions/51-l/mission-51-l.html\t5319\n/shuttle/missions/sts-69/images/images.html\t5271\n/shuttle/missions/sts-73/mission-sts-73.html\t5265\n/images/faq.gif\t5217\n/shuttle/countdown/lps/fr.gif\t5091\n/htbin/wais.pl\t5082\n/shuttle/countdown/lps/back.gif\t5080\n/shuttle/missions/sts-69/movies/movies.html\t4920\n/shuttle/resources/orbiters/atlantis.html\t4918\n/shuttle/missions/51-l/51-l-patch-small.gif\t4890\n/shuttle/resources/orbiters/discovery.html\t4782\n/shuttle/resources/orbiters/challenger.html\t4708\n/elv/elvpage.htm\t4661\n/history/apollo/apollo-13/\t4646\n/facilities/tour.html\t4639\n/shuttle/missions/sts-69/liftoff.html\t4559\n/images/launch-small.gif\t4558\n/shuttle/missions/sts-73/sts-73-patch-small.gif\t4544\n/shuttle/technology/sts-newsref/sts-lcc.html\t4438\n/history/mercury/mercury.html\t4431\n/history/apollo/apollo-spacecraft.txt\t4388\n/images/kscmap-small.gif\t4369\n/facts/about_ksc.html\t4367\n/shuttle/technology/images/mission_profile_2-small.gif\t4324\n/shuttle/resources/orbiters/atlantis-logo.gif\t4322\n/images/mercury-logo.gif\t4191\n/shuttle/missions/sts-71/movies/sts-71-launch.mpg\t4142\n/shuttle/resources/orbiters/challenger-logo.gif\t4138\n/shuttle/missions/sts-70/movies/woodpecker.mpg\t4117\n/shuttle/resources/orbiters/discovery-logo.gif\t4091\n/whats-new.html\t4044\n/history/apollo/apollo-13/images/\t4023\n/images/whatsnew.gif\t4018\n/history/apollo/apollo-1/apollo-1.html\t4013\n/icons/movie.xbm\t4009\n/shuttle/resources/orbiters/columbia.html\t4003\n/images/launchpalms-small.gif\t3986\n/history/apollo/apollo-13/movies/\t3767\n/shuttle/missions/sts-74/mission-sts-74.html\t3759\n/history/apollo/apollo-1/apollo-1-patch-small.gif\t3740\n/images/ksclogo.gif\t3719\n/elv/elvhead3.gif\t3637\n/shuttle/resources/orbiters/columbia-logo.gif\t3492\n/elv/endball.gif\t3419\n/history/gemini/gemini.html\t3395\n/shuttle/missions/sts-78/mission-sts-78.html\t3369\n/shuttle/missions/sts-68/mission-sts-68.html\t3360\n/elv/PEGASUS/minpeg1.gif\t3352\n/elv/SCOUT/scout.gif\t3328\n/shuttle/missions/sts-63/mission-sts-63.html\t3323\n/elv/DELTA/delta.gif\t3321\n/elv/TITAN/titan.gif\t3299\n/elv/ATLAS_CENTAUR/atlas.gif\t3293\n/shuttle/missions/sts-67/mission-sts-67.html\t3290\n/facilities/vab.html\t3253\n/shuttle/missions/sts-71/movies/crew-arrival-t38.mpg\t3250\n/history/apollo/apollo-13/sounds/\t3245\n/history/apollo/flight-summary.txt\t3221\n/shuttle/missions/sts-1/mission-sts-1.html\t3180\n/shuttle/missions/sts-67/sts-67-patch-small.gif\t3174\n/shuttle/missions/sts-74/sts-74-patch-small.gif\t3125\n/images/KSC-94EC-412-small.gif\t3115\n/images/vab-small.gif\t3102\n/history/skylab/skylab.html\t3078\n/shuttle/missions/sts-66/mission-sts-66.html\t3035\n/elv/struct.gif\t3005\n/shuttle/countdown/tour.html\t2997\n/images/gemini-logo.gif\t2985\n/icons/sound.xbm\t2973\n/shuttle/resources/orbiters/orbiters.html\t2971\n/history/skylab/skylab-small.gif\t2910\n/shuttle/missions/sts-78/sts-78-patch-small.gif\t2906\n/shuttle/technology/images/sts_spec_6-small.gif\t2904\n/facilities/mlp.html\t2874\n/shuttle/missions/sts-72/mission-sts-72.html\t2858\n/shuttle/missions/sts-63/sts-63-patch-small.gif\t2849\n/images/landing-small.gif\t2847\n/shuttle/missions/sts-68/sts-68-patch-small.gif\t2832\n/shuttle/missions/sts-68/ksc-srl-image.html\t2824\n/images/rss.gif\t2803\n/shuttle/missions/sts-1/sts-1-patch-small.gif\t2786\n/images/launch.gif\t2731\n/shuttle/missions/sts-71/movies/sts-71-launch-3.mpg\t2727\n/shuttle/technology/images/srb_16-small.gif\t2722\n/shuttle/technology/sts-newsref/sts_overview.html\t2719\n/shuttle/missions/51-l/\t2711\n/shuttle/missions/sts-68/images/ksc.gif\t2697\n/images/mlp-logo.gif\t2688\n/shuttle/technology/images/sts_body_2-small.gif\t2686\n/elv/elvhead2.gif\t2635\n/history/apollo/\t2634\n/shuttle/missions/sts-69/news/\t2626\n/shuttle/technology/images/launch_sites_8-small.gif\t2615\n/facts/facts.html\t2554\n/shuttle/missions/sts-71/images/KSC-95EC-0911.jpg\t2552\n/shuttle/technology/images/crew_compartment_13-small.gif\t2530\n/history/apollo/apollo-17/apollo-17.html\t2527\n/facts/faq04.html\t2520\n/shuttle/missions/\t2468\n/shuttle/missions/sts-68/images/ksc-upclose.gif\t2461\n/shuttle/missions/51-l/51-l-info.html\t2431\n/shuttle/missions/sts-72/sts-72-patch-small.gif\t2417\n/history/rocket-history.txt\t2416\n/shuttle/countdown/video/sts-69-prelaunch-pad.gif\t2385\n/facilities/lcc.html\t2370\n/history/apollo/apollo-17/apollo-17-patch-small.gif\t2360\n/shuttle/technology/sts-newsref/srb.html\t2348\n/shuttle/missions/sts-67/images/images.html\t2307\n/history/apollo/images/APOLLO-logosmall.gif\t2294\n/history/apollo/apollo-13/sounds/a13_002.wav\t2264\n/shuttle/missions/sts-71/images/KSC-95EC-0918.jpg\t2224\n/history/apollo/apollo-13/docs/\t2224\n/shuttle/missions/sts-71/images/KSC-95EC-0913.jpg\t2221\n/shuttle/missions/sts-66/sts-66-patch-small.gif\t2216\n/shuttle/technology/images/tal_abort_2-small.gif\t2215\n/history/mercury/mr-3/mr-3-patch-small.gif\t2206\n/shuttle/missions/sts-71/movies/sts-71-tcdt-crew-walkout.mpg\t2197\n/shuttle/missions/sts-69/\t2194\n/images/lcc-small2.gif\t2162\n/shuttle/technology/sts-newsref/sts_coord.html\t2100\n/mdss/MDSS.html\t2092\n/history/apollo/apollo-13/movies/apo13damage.mpg\t2087\n/shuttle/missions/sts-71/images/KSC-95EC-0912.jpg\t2081\n/shuttle/missions/sts-65/mission-sts-65.html\t2072\n/history/early-astronauts.txt\t2042\n/shuttle/countdown/count.html\t2026\n/shuttle/missions/sts-69/news\t2010\n/pub/winvn/readme.txt\t2004\n/shuttle/missions/sts-71/images/KSC-95EC-0917.jpg\t1999\n/shuttle/missions/sts-70/movies/sts-70-launch.mpg\t1988\n/shuttle/missions/sts-71/movies/sts-71-mir-dock.mpg\t1988\n/history/gemini/images/gemini-logo.gif\t1982\n/shuttle/missions/sts-71/images/KSC-95EC-0915.jpg\t1977\n/shuttle/technology/images/aft_fuselage_2-small.gif\t1950\n/shuttle/missions/sts-71/images/KSC-95EC-0916.jpg\t1898\n/history/apollo/apollo-13/news/\t1893\n/mdss/s_md-2.gif\t1886\n/shuttle/missions/sts-71/images/index71.gif\t1873\n/history/apollo/apollo-13/images/index.gif\t1855\n/shuttle/missions/sts-71/images/KSC-95EC-0423.gif\t1827\n/history/apollo/apollo-goals.txt\t1795\n/icon/constr.gif\t1785\n/shuttle/missions/rollbacks.html\t1777\n/history/apollo/images/apollo.gif\t1772\n/history/apollo/apollo-1/apollo-1-info.html\t1770\n/history/mercury/mr-3/mr-3.html\t1742\n/history/apollo/apollo-13/apollo-13-patch.jpg\t1732\n/pub/winvn/release.txt\t1732\n/images/rollback.gif\t1731\n/shuttle/technology/sts-newsref/sts-mps.html\t1729\n/elv/updated.gif\t1698\n/shuttle/resources/orbiters/enterprise.html\t1695\n/history/astp/astp.html\t1687\n/shuttle/missions/sts-69/sts-69-info.html\t1678\n/elv/new01.gif\t1675\n/shuttle/missions/sts-70/news/\t1665\n/shuttle/missions/61-c/mission-61-c.html\t1663\n/shuttle/missions/51-l/news/\t1632\n/shuttle/missions/sts-71/sts-71-press-kit.txt\t1627\n/history/astp/astp-patch-small.gif\t1621\n/shuttle/missions/sts-71/images/KSC-95EC-0423.jpg\t1619\n/shuttle/technology/sts-newsref/sts_mes.html\t1619\n/shuttle/missions/sts-70/o-ring-problem.gif\t1610\n/shuttle/missions/61-c/61-c-patch-small.gif\t1598\n/shuttle/resources/orbiters/enterprise-logo.gif\t1597\n/shuttle/technology/images/et_1-small.gif\t1586\n/shuttle/technology/images/et-intertank_1-small.gif\t1585\n/shuttle/missions/51-l/images/\t1582\n/images/landing-logo.gif\t1576\n/history/apollo/apollo-7/apollo-7.html\t1558\n/shuttle/technology/images/et-lox_1-small.gif\t1549\n/shuttle/missions/sts-69/endeavour-pad-prelaunch-8-31-95.gif\t1549\n/history/apollo/apollo-13/images/70HC314.GIF\t1547\n/history/apollo/apollo-1/\t1523\n/history/apollo/apollo-8/apollo-8.html\t1520\n/shuttle/missions/sts-75/mission-sts-75.html\t1518\n/finance/main.htm\t1516\n/history/apollo/apollo-14/apollo-14.html\t1506\n/shuttle/missions/sts-65/sts-65-patch-small.gif\t1505\n/history/apollo/apollo-10/apollo-10.html\t1503\n/shuttle/missions/sts-71/images/KSC-95EC-0911.gif\t1497\n/finance/collsm1.gif\t1478\n/shuttle/missions/sts-69/movies/ws-animation-deploy.mpg\t1461\n/shuttle/missions/sts-71/sts-71-info.html\t1453\n/shuttle/technology/sts-newsref/et.html\t1437\n/images/op-logo-small.gif\t1427\n/procurement/procurement.html\t1421\n/shuttle/missions/51-l/movies/\t1413\n/history/apollo/apollo-7/apollo-7-patch-small.gif\t1409\n/history/apollo/apollo-11/apollo-11-info.html\t1402\n/history/apollo/apollo-8/apollo-8-patch-small.gif\t1401\n/shuttle/missions/sts-64/mission-sts-64.html\t1396\n/shuttle/missions/100th.html\t1390\n/history/apollo/apollo-10/apollo-10-patch-small.gif\t1389\n/shuttle/missions/sts-70/images/DSC-95EC-0001.gif\t1381\n/facilities/opf.html\t1378\n/mdss/station.gif\t1378\n/finance/suit.gif\t1373\n/finance/links.gif\t1370\n/shuttle/countdown/video/landing.gif\t1367\n/finance/ref_btn.gif\t1364\n/shuttle/missions/sts-70/news\t1361\n/finance/webserch.gif\t1356\n/finance/tour.gif\t1350\n/finance/book.gif\t1348\n/history/apollo/apollo-14/apollo-14-patch-small.gif\t1346\n/software/winvn/faq/WINVNFAQ-Contents.html\t1344\n/software/winvn/wvlarge.gif\t1343\n/shuttle/missions/sts-71/news/\t1343\n/finance/toairpla.gif\t1343\n/shuttle/missions/sts-62/mission-sts-62.html\t1342\n/mdss/s_delta2.gif\t1341\n/shuttle/technology/sts-newsref/sts-cron.html\t1338\n/shuttle/missions/sts-69/sts-69-patch.jpg\t1336\n/finance/brrow_1t.gif\t1334\n/images/dual-pad.gif\t1332\n/images\t1318\n/mdss/dcy2.gif\t1316\n/shuttle/technology/sts-newsref/spacelab.html\t1315\n/elv/hot.gif\t1314\n/shuttle/missions/sts-71/images/KSC-95EC-0918.gif\t1314\n/history/apollo/apollo-12/apollo-12.html\t1310\n/shuttle/\t1303\n/images/lc39a.gif\t1292\n/shuttle/missions/sts-70/movies/sts-70-launch-srbsep.mpg\t1278\n/shuttle/missions/sts-69/images/KSC-95EC-0694.jpg\t1276\n/history/skylab/skylab-logo.gif\t1270\n/images/opf-logo.gif\t1270\n/shuttle/missions/sts-59/mission-sts-59.html\t1270\n/shuttle/missions/sts-69/images/KSC-95EC-0694.gif\t1269\n/history/apollo/apollo-sa.html\t1263\n/shuttle/missions/sts-75/sts-75-patch-small.gif\t1262\n/shuttle/technology/sts-newsref/mission_profile.html\t1244\n/shuttle/missions/sts-71/movies/sts-71-mir-dock-2.mpg\t1244\n/shuttle/missions/sts-69/sts-69-press-kit.txt\t1238\n/history/gemini/movies/gemini-launch.mpg\t1231\n/history/apollo/apollo-12/apollo-12-patch-small.gif\t1225\n/shuttle/missions/sts-69/movies/ws-animation-retrieval.mpg\t1224\n/shuttle/missions/sts-69/images/KSC-95EC-1032.jpg\t1205\n/shuttle/missions/sts-71/sts-71-patch.jpg\t1199\n/shuttle/countdown\t1190\n/images/crawler-logo.gif\t1174\n/shuttle/missions/sts-76/mission-sts-76.html\t1173\n/history/mercury/mercury-spacecraft.txt\t1171\n/shuttle/missions/sts-70/woodpecker.html\t1167\n/history/apollo/apollo-15/apollo-15.html\t1158\n/shuttle/missions/sts-77/mission-sts-77.html\t1152\n/shuttle/missions/sts-70/sts-70-press-kit.txt\t1149\n/history/apollo/images/little-joe.gif\t1148\n/shuttle/missions/sts-53/movies/sts-53-launch.mpg\t1148\n/shuttle/missions/sts-49/mission-sts-49.html\t1141\n/shuttle/missions/sts-70/sts-70-patch.jpg\t1140\n/software/winvn/userguide/wvnguide.html\t1132\n/persons/nasa-cm/jmd.html\t1126\n/shuttle/technology/sts-newsref/sts-jsc-comm.html\t1126\n/history/apollo/apollo-9/apollo-9.html\t1125\n/shuttle/missions/sts-62/sts-62-patch-small.gif\t1118\n/htbin/wais.pl?IMAX\t1113\n/history/apollo/apollo-5/apollo-5.html\t1103\n/shuttle/technology/sts-newsref/sts_egress.html\t1101\n/shuttle/missions/sts-69/images/index69.gif\t1096\n/history/apollo/apollo-13/images/70HC431.GIF\t1095\n/shuttle/missions/sts-71/images/KSC-95EC-0913.gif\t1082\n/shuttle/missions/sts-70/images/DSC-95EC-0001.jpg\t1082\n/shuttle/missions/sts-64/sts-64-patch-small.gif\t1078\n/shuttle/missions/sts-70/images/holes-in-et.gif\t1073\n/facts/faq12.html\t1071\n/history/apollo/apollo-4/apollo-4.html\t1069\n/shuttle/missions/sts-71/images/KSC-95EC-0912.gif\t1067\n/shuttle/technology/sts-newsref/sts-av.html\t1067\n/history/apollo/apollo-15/apollo-15-patch-small.gif\t1066\n/history/apollo/images/footprint.gif\t1061\n/shuttle/missions/sts-49/sts-49-patch-small.gif\t1060\n/shuttle/missions/61-b/61-b-patch-small.gif\t1058\n/shuttle/missions/sts-70/images/KSC-95EC-0768.jpg\t1056\n/facilities/crawler.html\t1055\n/history/apollo/apollo-13/sounds/a13_003.wav\t1051\n/software/winvn/userguide/winvnsm.gif\t1049\n/shuttle/missions/sts-71/images/KSC-95EC-0916.gif\t1045\n/shuttle/missions/sts-70/images/woodpecker-on-et.gif\t1044\n/history/apollo/apollo-11/\t1043\n/shuttle/missions/51-l/sounds/\t1042\n/shuttle/technology/sts-newsref/stsover-launch.html\t1041\n/shuttle/missions/61-b/mission-61-b.html\t1038\n/shuttle/missions/sts-70/images/index70.gif\t1037\n/history/apollo/apollo-13/sounds/a13_001.wav\t1035\n/shuttle/missions/sts-71/news\t1033\n/history/apollo/apollo-9/apollo-9-patch-small.gif\t1030\n/shuttle/missions/sts-26/mission-sts-26.html\t1025\n/facilities/spaceport.html\t1015\n/history/apollo/apollo-5/apollo-5-patch-small.gif\t1009\n/history/apollo/apollo-13/sounds/a13_004.wav\t1003\n/shuttle/missions/sts-71/images/KSC-95EC-0917.gif\t1001\n/shuttle/missions/sts-59/sts-59-patch-small.gif\t1000\n/shuttle/missions/sts-76/sts-76-patch-small.gif\t1000\n/history/apollo/as-201/as-201.html\t999\n/history/apollo/apollo-4/apollo-4-patch-small.gif\t999\n/msfc/astro_home.html\t989\n/images/kscarea-small.gif\t988\n/history/apollo/apollo-16/apollo-16.html\t987\n/shuttle/missions/sts-70/sts-70-info.html\t975\n/shuttle/missions/sts-77/sts-77-patch-small.gif\t970\n/shuttle/missions/sts-71/images/KSC-95EC-0443.jpg\t969\n/history/apollo/apollo-11/images/\t968\n/history/apollo/apollo-1/images/\t968\n/persons/nasa-cm/jmd.gif\t963\n/history/apollo/images/apollo-insignia.gif\t962\n/elv/bakgro.gif\t961\n/history/mercury/flight-summary.txt\t957\n/history/apollo/apollo-13/movies/apo13launch.mpg\t957\n/software/winvn/userguide/wvnguide.gif\t955\n/shuttle/missions/sts-71/images/KSC-95EC-0915.gif\t955\n/history/mercury/ma-6/ma-6.html\t948\n/msfc/astro_home3.gif\t946\n/elv/vidpicp.htm\t942\n/shuttle/technology/sts-newsref/stsover.html\t939\n/history/apollo/apollo-16/apollo-16-patch-small.gif\t939\n/shuttle/missions/sts-70/images/KSC-95EC-0515.gif\t936\n/history/mercury/mr-4/mr-4.html\t934\n/history/apollo/apollo-13/images/70HC418.GIF\t934\n/shuttle/missions/sts-69/countdown.html\t920\n/history/apollo/apollo-13/images/70HC323.GIF\t899\n/facilities/spaceport-logo-small.gif\t899\n/shuttle/missions/51-l/images/850128.GIF\t897\n/shuttle/missions/51-l/images/86HC159.GIF\t896\n/shuttle/technology/sts-newsref/sts-eps.html\t896\n/statistics/statistics.html\t896\n/shuttle/technology/sts-newsref/centers.html\t894\n/history/apollo/as-201/as-201-patch-small.gif\t891\n/facilities/slf.html\t890\n/images/slf-logo.gif\t887\n/shuttle/missions/sts-69/images/KSC-95EC-1032.gif\t884\n/history/apollo/apollo-6/apollo-6.html\t880\n/shuttle/missions/51-l/docs/\t872\n/shuttle/missions/sts-26/sts-26-patch-small.gif\t868\n/shuttle/missions/sts-71/images/KSC-95EC-0589.jpg\t868\n/shuttle/missions/sts-71/movies/sts-71-launch-2.mpg\t863\n/history/mercury/ma-6/ma-6-patch-small.gif\t861\n/elv/DELTA/del181s.gif\t855\n/history/apollo/apollo-17/apollo-17-info.html\t854\n/history/gemini/gemini-spacecraft.txt\t849\n/history/mercury/mr-4/mr-4-patch-small.gif\t847\n/history/mercury/mercury-overview.txt\t845\n/shuttle/missions/sts-71/movies/sts-71-landing.mpg\t844\n/elv/uncons.htm\t842\n/shuttle/missions/sts-70/images/KSC-95EC-0515.jpg\t841\n/shuttle/missions/51-l/images/86HC68.GIF\t840\n/shuttle/missions/sts-2/mission-sts-2.html\t839\n/shuttle/missions/sts-71/images/KSC-95EC-0613.jpg\t834\n/history/mercury/ma-9/ma-9.html\t831\n/history/\t829\n/history/gemini/gemini-3/gemini-3.html\t828\n/elv/TITAN/mars1s.jpg\t825\n/shuttle/missions/sts-71/movies/sts-71-hand-shake.mpg\t817\n/elv/TITAN/mars2s.jpg\t815\n/elv/DELTA/dsolidss.jpg\t814\n/shuttle/missions/sts-70/images/KSC-95EC-1012.jpg\t814\n/elv/TITAN/mars3s.jpg\t813\n/elv/ATLAS_CENTAUR/atc69s.jpg\t813\n/elv/ATLAS_CENTAUR/acsuns.jpg\t813\n/history/mercury/mercury-goals.txt\t810\n/shuttle/missions/sts-71/images/KSC-95EC-0443.gif\t806\n/elv/ATLAS_CENTAUR/goess.jpg\t804\n/shuttle/technology/sts-newsref/stsover-prep.html\t802\n/elv/DELTA/rosats.jpg\t796\n/elv/DELTA/delta.htm\t796\n/history/apollo/apollo-6/apollo-6-patch-small.gif\t795\n/shuttle/missions/sts-71/sts-71-day-01-highlights.html\t793\n/shuttle/missions/sts-70/images/KSC-95EC-0852.jpg\t787\n/elv/SCOUT/radcals.jpg\t785\n/elv/DELTA/euves.jpg\t785\n/shuttle/missions/sts-71/sts-71-day-03-highlights.html\t780\n/icon/new01.gif\t774\n/history/apollo/apollo-13/images/70HC517.GIF\t773\n/shuttle/missions/51-l/images/86HC125.GIF\t773\n/shuttle/missions/sts-73/news/\t772\n/shuttle/missions/sts-69/images/KSC-95EC-0760.jpg\t768\n/history/skylab/skylab-2.html\t768\n/shuttle/missions/sts-73/sts-73-info.html\t768\n/history/apollo/apollo-11/movies/\t766\n/shuttle/missions/sts-70/\t762\n/shuttle/missions/sts-69/erin.gif\t761\n/shuttle/missions/51-l/news\t761\n/history/gemini/gemini-xii/gemini-xii.html\t760\n/history/apollo/apollo-13/images/70HC464.GIF\t760\n/history/apollo/apollo-1/movies/\t758\n/history/apollo/apollo-13/movies/apo13inside.mpg\t756\n/elv/SCOUT/s_216s.jpg\t755\n/history/mercury/ma-9/ma-9-patch-small.gif\t753\n/shuttle/technology/sts-newsref/sts-apu.html\t751\n/shuttle/missions/sts-71/\t750\n/shuttle/missions/sts-70/movies/sts-70-launch-press.mpg\t746\n/shuttle/technology/sts-newsref/sts-gnnc.html\t745\n/shuttle/missions/51-l/images/86HC119.GIF\t741\n/history/gemini/gemini-3/gemini-3-patch-small.gif\t739\n/elv/SCOUT/sampexs.jpg\t737\n/shuttle/countdown/lps/osr/osr.html\t732\n/history/gemini/flight-summary.txt\t731\n/history/skylab/skylab-4.html\t730\n/shuttle/technology/sts-newsref/stsover-missions.html\t729\n/shuttle/missions/sts-71/movies/sts-71-rollover.mpg\t729\n/shuttle/missions/sts-69/movies/sts-69-rollback.mpg\t729\n/shuttle/missions/sts-2/sts-2-patch-small.gif\t715\n/shuttle/missions/sts-61/mission-sts-61.html\t708\n/history/skylab/skylab-station.txt\t706\n/htbin/wais.pl?TISP\t701\n/shuttle/missions/sts-71/images/KSC-95EC-0544.jpg\t695\n/history/apollo/apollo-1/news/\t695\n/history/gemini/gemini-xii/gemini-xii-patch-small.gif\t695\n/history/apollo/apollo-13/movies/apo13home.mpg\t690\n/history/apollo/apollo-13/images/70HC353.GIF\t689\n/shuttle/missions/sts-70/images/KSC-95EC-0649.jpg\t685\n/shuttle/missions/41-d/mission-41-d.html\t685\n/images/rollout.gif\t684\n/shuttle/missions/STS-69/mission-STS-69.html\t683\n/shuttle/missions/sts-9/mission-sts-9.html\t683\n/shuttle/missions/41-d/41-d-patch-small.gif\t673\n/history/apollo/apollo-1/sounds/\t672\n/shuttle/missions/sts-70/images/KSC-95EC-1018.jpg\t668\n/history/apollo/apollo-13/sounds/a13_005.wav\t666\n/facts/faq10.html\t662\n/shuttle/missions/sts-71/sts-71-day-04-highlights.html\t662\n/shuttle/missions/sts-70/images/KSC-95EC-1017.jpg\t658\n/history/apollo/apollo-13/images/70HC467.GIF\t657\n/shuttle/missions/51-j/mission-51-j.html\t657\n/history/skylab/skylab-4-small.gif\t657\n/shuttle/missions/sts-27/sts-27-patch-small.gif\t655\n/history/skylab/skylab-1.html\t654\n/images/kscmap.gif\t654\n/shuttle/missions/sts-70/images/KSC-95EC-0667.jpg\t654\n/shuttle/missions/sts-37/sts-37-patch-small.gif\t653\n/shuttle/missions/sts-27/mission-sts-27.html\t651\n/shuttle/missions/sts-70/images/KSC-95EC-0768.gif\t648\n/history/apollo/apollo-17/\t646\n/shuttle/missions/sts-34/mission-sts-34.html\t646\n/shuttle/missions/sts-37/mission-sts-37.html\t642\n/shuttle/missions/51-j/51-j-patch-small.gif\t641\n/shuttle/countdown/images/countclock.jpeg\t640\n/images/oldtower.gif\t638\n/shuttle/missions/sts-6/sts-6-patch-small.gif\t637\n/shuttle/missions/sts-70/movies/sts-70-tdrs-deploy.mpg\t635\n/elv/uplink.htm\t634\n/shuttle/missions/sts-70/images/KSC-95EC-1014.jpg\t631\n/shuttle/missions/sts-70/movies/sts-70-roll-back-pad.mpg\t631\n/persons/astronauts/u-to-z/YoungJW.txt\t631\n/history/apollo/apollo-11/sounds/\t627\n/shuttle/missions/sts-70/images/KSC-95EC-1013.jpg\t624\n/history/astp/astp-spacecraft.txt\t623\n/history/apollo/apollo-13/images/70HC496.GIF\t621\n/history/apollo/apollo-1/docs/\t618\n/history/mercury/ma-7/ma-7.html\t617\n/history/apollo/apollo-13/videos/\t614\n/shuttle/missions/sts-70/images/DSC-95EC-0006.jpg\t611\n/shuttle/missions/sts-71/images/KSC-95EC-0589.gif\t608\n/shuttle/movies/TDRSopen.mpg\t605\n/shuttle/missions/sts-70/images/KSC-95EC-1016.jpg\t604\n/shuttle/missions/sts-61/sts-61-patch-small.gif\t602\n/finance//brrow_1t.gif\t602\n/shuttle/missions/sts-71/sts-71-day-11-highlights.html\t600\n/shuttle/missions/sts-74/sts-74-info.html\t598\n/shuttle/technology/sts-newsref/sts_sys.html\t592\n/shuttle/missions/sts-6/mission-sts-6.html\t591\n/images/NASA-logo.gif\t590\n/shuttle/missions/sts-71/movies/sts-71-hatch-hand-group.mpg\t586\n/shuttle/missions/sts-9/sts-9-patch-small.gif\t585\n/history/gemini/gemini-goals.txt\t584\n/shuttle/missions/sts-71/sts-71-day-08-highlights.html\t582\n/images/launchpalms.gif\t577\n/shuttle/missions/41-b/mission-41-b.html\t573\n/software/winvn/\t572\n/history/mercury/ma-8/ma-8.html\t571\n/shuttle/missions/sts-74/\t569\n/shuttle/missions/41-b/41-b-patch-small.gif\t569\n/shuttle/missions/sts-60/mission-sts-60.html\t567\n/shuttle/missions/sts-71/sts-71-day-06-highlights.html\t565\n/shuttle/missions/51-c/mission-51-c.html\t564\n/shuttle/resources/orbiters/endeavour.gif\t563\n/history/apollo/apollo-11/apollo-11-patch.jpg\t562\n/shuttle/missions/sts-70/images/KSC-95EC-0635.jpg\t562\n/shuttle/missions/51-c/51-c-patch-small.gif\t560\n/history/astp/flight-summary.txt\t560\n/shuttle/missions/61-a/mission-61-a.html\t559\n/history/mercury/ma-7/ma-7-patch-small.gif\t557\n/shuttle/missions/sts-69/images/\t557\n/images/cm-logo.gif\t555\n/history/gemini/gemini-vii/gemini-vii.html\t554\n/shuttle/missions/51-l/51-l-crew.gif\t554\n/shuttle/missions/sts-71/movies/crew-arrival.mpg\t554\n/shuttle/missions/sts-71/images/KSC-95EC-0544.gif\t552\n/shuttle/missions/sts-70/images/KSC-95EC-1019.jpg\t552\n/shuttle/missions/sts-70/sts-70-day-01-highlights.html\t551\n/shuttle/missions/sts-57/sts-57-patch-small.gif\t551\n/history/apollo/apollo-1/images/66HC1519.gif\t549\n/shuttle/missions/sts-34/sts-34-patch-small.gif\t546\n/shuttle/missions/sts-74/news/\t544\n/shuttle/missions/sts-73/news\t543\n/shuttle/missions/sts-71/sts-71-day-02-highlights.html\t543\n/statistics/1995/Jul/Jul95.html\t542\n/history/apollo/sa-1/sa-1.html\t542\n/history/gemini/gemini-v/gemini-v.html\t540\n/images/landing.jpg\t539\n/shuttle/missions/sts-3/mission-sts-3.html\t539\n/history/gemini/gemini-1/gemini-1.html\t537\n/shuttle/missions/sts-71/sts-71-day-05-highlights.html\t536\n/history/apollo/apollo-17/images/\t534\n/shuttle/missions/sts-71/images/KSC-95EC-0613.gif\t530\n/shuttle/missions/sts-7/mission-sts-7.html\t529\n/software/winvn/userguide/docscont.gif\t528\n/shuttle/missions/sts-57/mission-sts-57.html\t527\n/software/winvn/userguide/docsleft.gif\t527\n/shuttle/missions/sts-7/sts-7-patch-small.gif\t526\n/shuttle/technology/sts-newsref/sts-inst.html\t526\n/procurement/midrange/equip.htm\t525\n/history/gemini/gemini-viii/gemini-viii.html\t524\n/software/winvn/userguide/docsrigh.gif\t524\n/elv/whnew.htm\t522\n/history/apollo/apollo-13/images/70HC507.GIF\t520\n/history/apollo/apollo-8/apollo-8-info.html\t520\n/shuttle/technology/sts-newsref/sts-oms.html\t519\n/shuttle/technology/sts-newsref/sts-subs.html\t515\n/shuttle/technology/sts-newsref/sts-ovcomm.html\t515\n/shuttle/missions/sts-35/mission-sts-35.html\t514\n/history/gemini/gemini-4/gemini-4.html\t512\n/shuttle/missions/sts-69/images/KSC-95EC-0760.gif\t509\n/shuttle/missions/sts-71/images/KSC-95EC-0951.jpg\t509\n/history/mercury/ma-8/ma-8-patch-small.gif\t508\n/shuttle/technology/sts-newsref/sts-jsc.html\t502\n/elv/DELTA/delta_lo.gif\t501\n/shuttle/missions/sts-70/images/KSC-95EC-1020.jpg\t500\n/shuttle/missions/sts-missions-flown.txt\t499\n/shuttle/missions/sts-73/\t498\n/htbin/wais.pl?51-L\t498\n/statistics/images/getstats_big.gif\t497\n/statistics/images/statsm.gif\t496\n/shuttle/missions/41-g/mission-41-g.html\t493\n/shuttle/missions/sts-71/images/KSC-95EC-0948.jpg\t492\n/shuttle/missions/sts-69/images/KSC-95EC-0969.jpg\t492\n/history/gemini/gemini-vii/gemini-vii-patch-small.gif\t491\n/software/winvn/faq/WINVNFAQ-I-6.html\t491\n/payloads/cm-systems.html\t490\n/shuttle/missions/sts-70/images/KSC-95EC-1015.jpg\t486\n/shuttle/missions/sts-4/mission-sts-4.html\t486\n/images/bluemarb.gif\t485\n/shuttle/missions/61-a/61-a-patch-small.gif\t484\n/facts/faq07.html\t483\n/shuttle/missions/sts-60/sts-60-patch-small.gif\t483\n/history/skylab/skylab-goals.txt\t481\n/shuttle/missions/sts-70/images/KSC-95EC-0585.jpg\t481\n/history/gemini/gemini-v/gemini-v-patch-small.gif\t480\n/history/skylab/skylab-3.html\t479\n/history/gemini/gemini-viii/gemini-viii-patch-small.gif\t478\n/history/skylab/flight-summary.txt\t478\n/shuttle/missions/sts-78/\t477\n/shuttle/missions/sts-70/images/KSC-95EC-0852.gif\t477\n/shuttle/countdown/lps/mstr/mstr.html\t477\n/shuttle/missions/sts-71/sts-71-day-07-highlights.html\t475\n/htbin/wais.pl?SAREX-II\t475\n/shuttle/missions/51-b/mission-51-b.html\t474\n/shuttle/missions/51-a/mission-51-a.html\t471\n/images/IMPACT.JPG\t470\n/history/apollo/as-202/as-202.html\t468\n/shuttle/missions/sts-29/sts-29-patch-small.gif\t466\n/history/apollo/as-203/as-203.html\t464\n/history/mercury/mr-3/mr-3-patch.gif\t463\n/shuttle/missions/sts-8/mission-sts-8.html\t461\n/shuttle/missions/sts-5/sts-5-patch-small.gif\t461\n/shuttle/resources/orbiters/pathfinder.html\t460\n/history/gemini/gemini-overview.txt\t457\n/shuttle/missions/51-d/51-d-patch-small.gif\t457\n/history/gemini/gemini-1/gemini-1-patch-small.gif\t457\n/shuttle/missions/51-f/mission-51-f.html\t456\n/shuttle/missions/sts-35/sts-35-patch-small.gif\t456\n/history/apollo/apollo-14/apollo-14-info.html\t454\n/shuttle/missions/sts-29/mission-sts-29.html\t453\n/shuttle/technology/sts-newsref/sts-rcs.html\t452\n/shuttle/missions/sts-70/images/KSC-95EC-0649.gif\t451\n/elv/TITAN/titan.htm\t450\n/history/apollo/apollo-11/sounds/A01106AA.WAV\t450\n/shuttle/missions/51-d/mission-51-d.html\t448\n/history/skylab/skylab.jpg\t448\n/shuttle/missions/sts-3/sts-3-patch-small.gif\t447\n/shuttle/missions/sts-69/movies/ws-animation-onorbit.mpg\t445\n/history/gemini/gemini-4/gemini-4-patch-small.gif\t444\n/shuttle/missions/sts-51/sts-51-patch-small.gif\t440\n/facts/faq11.html\t437\n/shuttle/missions/41-c/mission-41-c.html\t437\n/history/gemini/gemini-vi-a/gemini-vi-a.html\t436\n/statistics/1995/Jul/Jul95_request.gif\t436\n/images/263_small.jpg\t434\n/elv/movie.htm\t434\n/history/apollo/as-202/as-202-patch-small.gif\t432\n/shuttle/missions/51-i/mission-51-i.html\t430\n/history/apollo/apollo-1/images/67HC33a.gif\t429\n/shuttle/missions/sts-30/mission-sts-30.html\t429\n/statistics/1995/Jul/Jul95_byte.gif\t428\n/shuttle/missions/sts-68/ksc-upclose.gif\t428\n/shuttle/missions/sts-5/mission-sts-5.html\t428\n/shuttle/missions/sts-70/images/KSC-95EC-0540.jpg\t427\n/history/apollo/apollo-11/images/index.gif\t427\n/shuttle/missions/sts-28/sts-28-patch-small.gif\t427\n/shuttle/missions/sts-51/mission-sts-51.html\t427\n/shuttle/missions/51-g/51-g-patch-small.gif\t426\n/shuttle/missions/51-g/mission-51-g.html\t425\n/shuttle/missions/sts-71/images/KSC-95EC-0946.jpg\t425\n/history/gemini/gemini-x/gemini-x.html\t423\n/shuttle/missions/sts-28/mission-sts-28.html\t423\n/shuttle/technology/sts-newsref/sts-rhc.html\t422\n/shuttle/missions/51-l/51-l-patch.jpg\t421\n/history/skylab/skylab-operations.txt\t420\n/shuttle/countdown/lps/images/MASTER.gif\t417\n/history/apollo/as-203/as-203-patch-small.gif\t417\n/shuttle/missions/41-g/41-g-patch-small.gif\t417\n/procurement/midrange/rfo.htm\t414\n/facts/launch-pass.txt\t413\n/shuttle/missions/sts-70/images/KSC-95EC-1012.gif\t412\n/shuttle/missions/51-a/51-a-patch-small.gif\t412\n/shuttle/missions/sts-31/mission-sts-31.html\t412\n/shuttle/missions/51-i/51-i-patch-small.gif\t412\n/shuttle/missions/sts-40/mission-sts-40.html\t407\n/facts/faq01.html\t407\n/shuttle/missions/sts-41/mission-sts-41.html\t407\n/images/vab-medium.gif\t407\n/shuttle/countdown/lps/aa/aa.html\t406\n/shuttle/missions/sts-73/news/sts-73-mir-01.txt\t404\n/facilities/mila.html\t404\n/shuttle/missions/51-b/51-b-patch-small.gif\t403\n/shuttle/missions/sts-4/sts-4-patch-small.gif\t400\n/shuttle/missions/sts-45/sts-45-patch-small.gif\t400\n/history/apollo/apollo-12/apollo-12-info.html\t400\n/shuttle/missions/sts-8/sts-8-patch-small.gif\t400\n/shuttle\t399\n/history/apollo/apollo-1/images/apollo-1-crew.gif\t397\n/shuttle/missions/sts-69/movies/sts-69-payloads.mpg\t397\n/shuttle/missions/sts-47/mission-sts-47.html\t390\n/shuttle/missions/sts-69/movies/\t390\n/shuttle/missions/sts-70/images/KSC-95EC-1018.gif\t390\n/msfc/onboard/come_aboard.gif\t389\n/shuttle/technology/sts-newsref/sts-acronyms.html\t388\n/history/gemini/gemini-x/gemini-x-patch-small.gif\t388\n/shuttle/missions/sts-72/\t387\n/history/apollo/apollo-1/images/67HC21.gif\t387\n/shuttle/missions/sts-69/docs/\t386\n/history/astp/astp-goals.txt\t384\n/shuttle/missions/51-f/51-f-patch-small.gif\t384\n/history/apollo/a-001/a-001-patch-small.gif\t384\n/shuttle/missions/sts-55/mission-sts-55.html\t383\n/history/apollo/sa-1/sa-1-patch-small.gif\t383\n/shuttle/missions/sts-71/movies/sts-71-hatch-open.mpg\t383\n/shuttle/missions/sts-71/images/KSC-95EC-0909.jpg\t382\n/://spacelink.msfc.nasa.gov\t381\n/history/gemini/gemini-vi-a/gemini-vi-a-patch-small.gif\t380\n/shuttle/countdown/launch-team.html\t379\n/history/apollo/apollo-1/images/67HC33.gif\t379\n/shuttle/missions/sts-70/images/KSC-95EC-1017.gif\t379\n/history/gemini/gemini-ix-a/gemini-ix-a.html\t377\n/images/mlp.gif\t377\n/shuttle/missions/sts-39/mission-sts-39.html\t376\n/shuttle/missions/sts-71/sts-71-day-09-highlights.html\t376\n/shuttle/missions/sts-56/mission-sts-56.html\t375\n/images/crawlerway-logo.gif\t374\n/shuttle/missions/sts-30/sts-30-patch-small.gif\t373\n/shuttle/missions/sts-50/mission-sts-50.html\t373\n/elv/DELTA/uncons.htm\t372\n/shuttle/missions/41-c/41-c-patch-small.gif\t371\n/history/gemini/gemini-xi/gemini-xi.html\t370\n/shuttle/missions/sts-39/sts-39-patch-small.gif\t370\n/history/apollo/apollo-1/images/67HC31.gif\t369\n/shuttle/missions/sts-70/images/KSC-95EC-1013.gif\t366\n/software/\t365\n/facilities/milapict.gif\t363\n/shuttle/missions/sts-70/images/KSC-95EC-1014.gif\t363\n/elv/DELTA/dedesc.htm\t362\n/shuttle/resources/orbiters/mpta-098.html\t360\n/history/apollo/pad-abort-test-1/pad-abort-test-1-patch-small.gif\t359\n/images/crawler.gif\t359\n/history/apollo/apollo-14/\t358\n/shuttle/missions/sts-71/images/KSC-95EC-0950.jpg\t358\n/shuttle/missions/sts-71/images/KSC-95EC-0906.jpg\t356\n/shuttle/missions/sts-70/images/KSC-95EC-0667.gif\t355\n/shuttle/missions/sts-41/sts-41-patch-small.gif\t354\n/shuttle/missions/sts-32/sts-32-patch-small.gif\t354\n/shuttle/missions/sts-71/movies/sts-71-undocking.mpg\t354\n/history/apollo/apollo-17/movies/\t353\n/shuttle/missions/sts-71/movies/sts-71-rollout.mpg\t353\n/shuttle/missions/sts-33/sts-33-patch-small.gif\t352\n/elv/ATLAS_CENTAUR/atlcent.htm\t352\n/shuttle/missions/sts-71/images/\t352\n/images/kscmap-logo.gif\t348\n/shuttle/missions/sts-70/images/KSC-95EC-0635.gif\t348\n/shuttle/technology/sts-newsref/sts_eclss.html\t347\n/shuttle/missions/sts-70/sts-70-day-02-highlights.html\t346\n/facilities/milaptch.gif\t346\n/shuttle/missions/sts-71/movies/\t345\n/shuttle/missions/sts-32/mission-sts-32.html\t344\n/shuttle/missions/sts-31/sts-31-patch-small.gif\t342\n/shuttle/missions/sts-70/images/KSC-95EC-0711.jpg\t341\n/shuttle/missions/sts-40/sts-40-patch-small.gif\t341\n/history/apollo/apollo-12/\t340\n/shuttle/missions/sts-33/mission-sts-33.html\t340\n/shuttle/missions/sts-71/sts-71-day-10-highlights.html\t340\n/facilities/lps.html\t339\n/shuttle/countdown/countdown70.html\t338\n/shuttle/missions/sts-36/sts-36-patch-small.gif\t337\n/shuttle/missions/sts-45/mission-sts-45.html\t336\n/history/apollo/apollo-15/apollo-15-info.html\t335\n/shuttle/missions/sts-74/news\t335\n/shuttle/missions/sts-50/sts-50-patch-small.gif\t334\n/shuttle/missions/sts-47/sts-47-patch-small.gif\t334\n/facilities/pdlpict.gif\t334\n/shuttle/missions/sts-38/sts-38-patch-small.gif\t334\n/mdss/s_md-1.gif\t332\n/history/gemini/gemini-ix-a/gemini-ix-a-patch-small.gif\t331\n/shuttle/missions/sts-70/images/KSC-95EC-1016.gif\t331\n/images/lps-small.gif\t331\n/history/gemini/gemini-xi/gemini-xi-patch-small.gif\t329\n/finance/bmarcube.gif\t328\n/shuttle/missions/sts-36/mission-sts-36.html\t328\n/images/KSC-94EC-412.jpg\t327\n/shuttle/missions/sts-55/sts-55-patch-small.gif\t326\n/shuttle/missions/sts-70/movies/sts-70-landing-2.mpg\t324\n/shuttle/missions/sts-70/images/KSC-95EC-0585.gif\t324\n/shuttle/missions/sts-67/images/KSC-95EC-0390.jpg\t322\n/statistics/images/newstat.gif\t322\n/shuttle/missions/sts-56/sts-56-patch-small.gif\t321\n/images/nasa-logo.gif\t319\n/shuttle/technology/sts-newsref/sts-msfc.html\t318\n/shuttle/missions/sts-38/mission-sts-38.html\t317\n/shuttle/technology/images/et_1.jpg\t315\n/msfc/onboard/onboard.html\t315\n/shuttle/missions/sts-67/images/KSC-95EC-0390.gif\t314\n/shuttle/resources/orbiters/atlantis.gif\t314\n/shuttle/missions/sts-46/sts-46-patch-small.gif\t314\n/shuttle/missions/sts-72/sts-72-info.html\t310\n/shuttle/missions/sts-71/images/KSC-95EC-0747.jpg\t310\n/history/apollo/sa-10/sa-10.html\t309\n/shuttle/countdown/lps/images/AA-ROW.gif\t309\n/shuttle/technology/sts-newsref/sts-caws.html\t309\n/shuttle/missions/sts-71/images/KSC-95EC-0423.txt\t308\n/shuttle/countdown/lps/omr/omr.html\t308\n/shuttle/missions/sts-54/mission-sts-54.html\t308\n/shuttle/missions/sts-69/images/KSC-95EC-0969.gif\t308\n/shuttle/missions/sts-72/news/\t307\n/shuttle/missions/sts-71/sounds/\t307\n/finance/pmarcube.gif\t307\n/shuttle/missions/sts-52/mission-sts-52.html\t307\n/history/gemini/gemini-2/gemini-2.html\t307\n/shuttle/missions/sts-53/mission-sts-53.html\t306\n/shuttle/missions/sts-67/images/KSC-95EC-0397.gif\t306\n/shuttle/technology/sts-newsref/sts-eclss-wcl.html\t305\n/shuttle/missions/sts-70/images/KSC-95EC-1019.gif\t305\n/history/apollo/apollo-13.html\t304\n/images/shuttle-patch.jpg\t303\n/history/apollo/apollo-16/apollo-16-info.html\t302\n/shuttle/missions/sts-58/mission-sts-58.html\t302\n/images/oc.gif\t301\n/images/imagemaps/\t301\n/shuttle/missions/sts-70/images/KSC-95EC-1059.jpg\t299\n/shuttle/missions/sts-70/news/shuttle-status-5-25.txt\t296\n/welcome.html\t296\n/shuttle/countdown/images/KSC-81EC-84.gif\t296\n/facilities/oc.html\t295\n/history/apollo/apollo-11/images/690700.GIF\t294\n/shuttle/missions/sts-42/sts-42-patch-small.gif\t294\n/history/apollo/pad-abort-test-1/pad-abort-test-1.html\t293\n/software/winvn/faq/WINVNFAQ-I-3.html\t292\n/shuttle/missions/sts-78/news/\t292\n/htbin/wais.pl?STS-69\t291\n/shuttle/missions/sts-67/images/KSC-95EC-0395.gif\t291\n/shuttle/missions/sts-48/mission-sts-48.html\t291\n/shuttle/missions/sts-46/mission-sts-46.html\t291\n/shuttle/missions/sts-48/sts-48-patch-small.gif\t290\n/images/landing-747.gif\t289\n/shuttle/technology/sts-newsref/sts-lc39.html\t289\n/shuttle/missions/sts-70/images/KSC-95EC-0823.jpg\t288\n/shuttle/technology/sts-newsref/carriers.html\t287\n/shuttle/missions/sts-71/images/KSC-95EC-0893.jpg\t287\n/shuttle/missions/sts-67/images/KSC-95EC-0395.jpg\t286\n/shuttle/countdown/images/lccteam.gif\t285\n/elv/TITAN/titdesc.htm\t285\n/shuttle/missions/sts-67/images/KSC-95EC-0397.jpg\t285\n/history/apollo/apollo-11/sounds/A01108AA.WAV\t284\n/history/apollo/apollo-8/images/\t283\n/shuttle/missions/sts-70/images/KSC-95EC-0998.jpg\t279\n/history/apollo/apollo-11/images/69HC761.GIF\t279\n/shuttle/missions/sts-43/sts-43-patch-small.gif\t279\n/shuttle/missions/sts-70/images/KSC-95EC-0540.gif\t277\n/shuttle/missions/sts-58/sts-58-patch-small.gif\t277\n/shuttle/missions/sts-43/mission-sts-43.html\t277\n/shuttle/missions/sts-70/images/KSC-95EC-1020.gif\t276\n/shuttle/missions/sts-42/mission-sts-42.html\t276\n/history/apollo/apollo-14/images/\t275\n/shuttle/technology/sts-newsref/sts-gear.html\t275\n/cgi-bin/geturlstats.pl\t274\n/shuttle/missions/sts-44/sts-44-patch-small.gif\t274\n/history/apollo/apollo-8/\t273\n/msfc/onboard/colorbar.gif\t273\n/history/apollo/apollo-11/docs/\t273\n/shuttle/missions/sts-1/sts-1-info.html\t271\n/msfc/onboard/redball.gif\t271\n/shuttle/missions/sts-71/images/KSC-95EC-0907.jpg\t271\n/history/apollo/apollo-1/apollo-1-patch.jpg\t269\n/shuttle/missions\t269\n/shuttle/missions/sts-71/images/KSC-95EC-0951.gif\t269\n/shuttle/missions/sts-52/sts-52-patch-small.gif\t268\n/shuttle/missions/sts-44/mission-sts-44.html\t268\n/shuttle/missions/sts-53/sts-53-patch-small.gif\t268\n/shuttle/missions/sts-70/countdown.html\t268\n/history/apollo/a-001/a-001.html\t267\n/shuttle/missions/sts-70/images/KSC-95EC-1060.jpg\t266\n/facilities/crawlerway.html\t266\n/shuttle/resources/orbiters/columbia.gif\t264\n/software/winvn/faq/WINVNFAQ-I-7.html\t264\n/shuttle/missions/sts-70/images/KSC-95EC-1015.gif\t263\n/shuttle/resources/orbiters/discovery.gif\t263\n/shuttle/missions/sts-54/sts-54-patch-small.gif\t262\n/shuttle/missions/sts-71/images/KSC-95EC-0882.jpg\t261\n/shuttle/missions/sts-70/images/KSC-95EC-0705.jpg\t259\n/shuttle/missions/sts-73/images/\t259\n/history/gemini/gemini-2/gemini-2-patch-small.gif\t259\n/images/flight-deck.gif\t258\n/images/shuttle2.gif\t255\n/shuttle/missions/sts-71/images/KSC-95EC-0871.jpg\t254\n/shuttle/movies/\t254\n/shuttle/missions/sts-63/sts-63-info.html\t253\n/shuttle/missions/sts-67/images/KSC-95EC-0381.gif\t253\n/images/gemini.gif\t250\n/shuttle/missions/manifest.txt\t250\n/history/apollo/apollo-15/images/\t250\n/shuttle/missions/sts-71/images/KSC-95EC-0911.txt\t249\n/history/gemini/gemini-3/gemini-3-info.html\t248\n/history/apollo/apollo-10/apollo-10-info.html\t247\n/history/apollo/apollo-10/\t245\n/history/apollo/apollo-15/\t245\n/elv/PEGASUS/pegdesc.htm\t244\n/shuttle/technology/images/mission_profile_2.jpg\t244\n/history\t243\n/history/apollo/apollo-17/images/721200.GIF\t243\n/history/apollo\t243\n/shuttle/missions/sts-70/count70.gif\t242\n/shuttle/countdown/lps/c-1/c-1.html\t242\n/shuttle/countdown/lps/c-5-6/c-5-6.html\t241\n/history/apollo/apollo-11/images/69HC905.GIF\t239\n/shuttle/missions/sts-71/images/KSC-95EC-0868.jpg\t239\n/history/apollo/apollo-16/\t238\n/shuttle/missions/sts-78/news\t238\n/shuttle/countdown/lps/ab/ab.html\t238\n/history/gemini/gemini-xii/gemini-xii-info.html\t237\n/shuttle/technology/\t235\n/shuttle/missions/sts-70/sts-70-day-04-highlights.html\t235\n/history/apollo/apollo-12/images/\t234\n/software/winvn/faq/WINVNFAQ-I-2.html\t234\n/shuttle/missions/sts-1/\t234\n/shuttle/missions/sts-70/sts-70-day-08-highlights.html\t234\n/shuttle/missions/sts-71/images/KSC-95EC-0948.gif\t233\n/shuttle/missions/sts-71/images/KSC-95EC-0869.jpg\t233\n/images/STS-5.JPG\t232\n/shuttle/countdown/lps/bkup-intg/bkup-intg.html\t232\n/shuttle/missions/sts-70/movies/sts-70-landing.mpg\t232\n/elv/TITAN/tit2desc.htm\t229\n/shuttle/missions/sts-69/sounds/\t229\n/history/apollo/apollo-7/apollo-7-info.html\t228\n/history/apollo/apollo-17/sounds/\t228\n/cgi-bin/newwvn-mail.pl\t226\n/images/press-site-logo.gif\t225\n/mdss/stationproc.html\t224\n/facilities/press.html\t223\n/history/apollo/apollo-17/images/72HC670.GIF\t221\n/images/cdrom-1-95/\t221\n/shuttle/missions/sts-78/sts-78-info.html\t220\n/shuttle/missions/sts-71/images/KSC-95EC-0947.jpg\t220\n/elv/DELTA/deprev.htm\t219\n/shuttle/missions/sts-67/images/KSC-95EC-0381.jpg\t218\n/shuttle/missions/sts-57/\t217\n/statistics/1995/Jun/Jun95.html\t216\n/shuttle/missions/sts-71/movies/crew-walkout.mpg\t216\n/history/apollo/apollo-4/apollo-4-info.html\t215\n/elv/TITAN/mars1.jpg\t214\n/shuttle/missions/sts-69/images/KSC-95EC-0694.txt\t214\n/shuttle/missions/sts-71/images/KSC-95EC-0918.txt\t213\n/elv/DELTA/delseps.jpg\t213\n/history/apollo/apollo-16/images/\t213\n/history/apollo/apollo-17/images/73HC182.GIF\t212\n/shuttle/missions/sts-71/images/KSC-95EC-0747.gif\t212\n/shuttle/missions/sts-74/images/\t212\n/software/winvn/faq/WINVNFAQ-I-4.html\t212\n/history/apollo/apollo-1/apollo-1.txt\t212\n/shuttle/missions/sts-70/images/KSC-95EC-0622.jpg\t212\n/shuttle/missions/sts-70/images/KSC-95EC-0711.gif\t210\n/elv/ATLAS_CENTAUR/acsun.jpg\t210\n/shuttle/missions/sts-70/images/KSC-95EC-1057.jpg\t210\n/history/apollo/apollo-11/images/69HC1119.GIF\t209\n/shuttle/missions/sts-70/images/KSC-95EC-1056.jpg\t209\n/shuttle/missions/sts-70/sts-70-day-07-highlights.html\t208\n/shuttle/missions/sts-70/movies/sts-70-crew-walkout.mpg\t207\n/shuttle/missions/sts-1/sts-1-patch.jpg\t206\n/shuttle/missions/sts-70/movies/sts-70-tdrs-processing.mpg\t206\n/shuttle/missions/sts-74/sts-74-patch.jpg\t206\n/shuttle/missions/sts-71/images/KSC-95EC-0909.gif\t206\n/shuttle/missions/sts-70/movies/sts-70-crew-arrival.mpg\t205\n/history/apollo/apollo-11/news/\t205\n/persons/astronauts/a-to-d/CrippenRL.txt\t205\n/shuttle/countdown/lps/c-2/c-2.html\t205\n/facilities/sspf.html\t204\n/history/apollo/apollo-11/images/69HC680.GIF\t204\n/shuttle/missions/sts-71/images/KSC-95EC-0946.gif\t204\n/shuttle/countdown/lps/c-11-12/c-11-12.html\t204\n/shuttle/missions/sts-70/sts-70-day-06-highlights.html\t203\n/shuttle/technology/sts-newsref/sts-tps.html\t203\n/shuttle/missions/sts-71/images/KSC-95EC-0876.jpg\t203\n/shuttle/missions/sts-67/images/KSC-95EC-0392.gif\t203\n/shuttle/technology/sts-newsref/stsover-chron.html\t202\n/shuttle/missions/sts-72/news\t202\n/shuttle/missions/sts-70/images/KSC-95EC-1058.jpg\t201\n/shuttle/missions/sts-71/images/KSC-95EC-0902.jpg\t201\n/shuttle/countdown/images/cdtclock-large.gif\t198\n/htbin/wais.pl?STS-71\t198\n/elv/ATLAS_CENTAUR/atc69.jpg\t198\n/elv/DELTA/dsolids.jpg\t197\n/finance/search.htm\t197\n/shuttle/countdown/lps/images/C-5-6.gif\t197\n/persons/nasa-cm/mtd.html\t196\n/elv/DELTA/deline.gif\t195\n/facts/faq06.html\t195\n/history/apollo/apollo-11/images/69HC683.GIF\t195\n/shuttle/missions/sts-70/images/\t195\n/history/apollo/images/\t195\n/shuttle/missions/sts-70/images/KSC-95EC-0999.jpg\t195\n/elv/koreamin.gif\t194\n"
          },
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"result-alert alert-warning\" role\u003d\"alert\"\u003e\u003cbutton type\u003d\"button\" class\u003d\"close\" data-dismiss\u003d\"alert\" aria-label\u003d\"Close\"\u003e\u003cspan aria-hidden\u003d\"true\"\u003e\u0026times;\u003c/span\u003e\u003c/button\u003e\u003cstrong\u003eOutput is truncated\u003c/strong\u003e to 1000 rows. Learn more about \u003cstrong\u003ezeppelin.spark.maxResult\u003c/strong\u003e\u003c/div\u003e\n"
          },
          {
            "type": "TEXT",
            "data": "val \u001b[1m\u001b[34mpathsDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [path: string, count: bigint]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d48"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d49"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863462_1455250262",
      "id": "20180421-172538_575851603",
      "dateCreated": "2025-03-30 13:37:43.462",
      "dateStarted": "2025-03-30 13:44:43.089",
      "dateFinished": "2025-03-30 13:44:44.086",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (3f) Example: Top Paths\n\nFor the final example, we\u0027ll find the top paths (URIs) in the log.  Because we sorted `pathsDF` for plotting, all we need to do is call `.show()` and pass in `numRows \u003d 10` and `truncate \u003d false` as the parameters to show the top ten paths without truncating.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.462",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(3f) Example: Top Paths\u003c/h3\u003e\n\u003cp\u003eFor the final example, we\u0026rsquo;ll find the top paths (URIs) in the log.  Because we sorted \u003ccode\u003epathsDF\u003c/code\u003e for plotting, all we need to do is call \u003ccode\u003e.show()\u003c/code\u003e and pass in \u003ccode\u003enumRows \u003d 10\u003c/code\u003e and \u003ccode\u003etruncate \u003d false\u003c/code\u003e as the parameters to show the top ten paths without truncating.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863462_165250947",
      "id": "20180421-173241_209552169",
      "dateCreated": "2025-03-30 13:37:43.462",
      "status": "READY"
    },
    {
      "text": "%spark\n// Top Paths\nprintln(\"Top Ten Paths:\")\npathsDF.show(numRows \u003d 10, truncate \u003d false)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:44:52.993",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Top Ten Paths:\n+---------------------------------------+------+\n|path                                   |count |\n+---------------------------------------+------+\n|/images/NASA-logosmall.gif             |208798|\n|/images/KSC-logosmall.gif              |164976|\n|/images/MOSAIC-logosmall.gif           |127916|\n|/images/USA-logosmall.gif              |127082|\n|/images/WORLD-logosmall.gif            |125933|\n|/images/ksclogo-medium.gif             |121580|\n|/ksc.html                              |83918 |\n|/images/launch-logo.gif                |76009 |\n|/history/apollo/images/apollo-logo1.gif|68898 |\n|/shuttle/countdown/                    |64740 |\n+---------------------------------------+------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d50"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d51"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863462_843596784",
      "id": "20180421-172829_389472073",
      "dateCreated": "2025-03-30 13:37:43.462",
      "dateStarted": "2025-03-30 13:44:53.004",
      "dateFinished": "2025-03-30 13:44:53.854",
      "status": "FINISHED"
    },
    {
      "text": "%md\n## Part 4: Exercises - Analyzing Web Server Log File\n\nNow it is your turn to perform analyses on the web server log files.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.463",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003ePart 4: Exercises - Analyzing Web Server Log File\u003c/h2\u003e\n\u003cp\u003eNow it is your turn to perform analyses on the web server log files.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863463_955134401",
      "id": "20180421-173648_910872231",
      "dateCreated": "2025-03-30 13:37:43.463",
      "status": "READY"
    },
    {
      "text": "%md\n**(4a) Exercise: Top Ten Error Paths**\n\nWhat are the top ten paths which did not have return code 200? Create a sorted list containing the paths and the number of times that they were accessed with a non-200 return code and show the top ten.\n\nThink about the steps that you need to perform to determine which paths did not have a 200 return code, how you will uniquely count those paths and sort the list.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.463",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003e\u003cstrong\u003e(4a) Exercise: Top Ten Error Paths\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eWhat are the top ten paths which did not have return code 200? Create a sorted list containing the paths and the number of times that they were accessed with a non-200 return code and show the top ten.\u003c/p\u003e\n\u003cp\u003eThink about the steps that you need to perform to determine which paths did not have a 200 return code, how you will uniquely count those paths and sort the list.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863463_2112863174",
      "id": "20180421-173659_817704274",
      "dateCreated": "2025-03-30 13:37:43.463",
      "status": "READY"
    },
    {
      "text": "%spark\n// TODO: Replace \u003cFILL IN\u003e with appropriate code\n// You are welcome to structure your solution in a different way, so long as\n// you ensure the variables used in the next Test section are defined\n\n// DataFrame containing all accesses that did not return a code 200\n\nval not200DF \u003d logsDF\n    .filter(col(\"status\") \u003d!\u003d 200)\nnot200DF.show(10)\n// Sorted DataFrame containing all paths and the number of times they were accessed with non-200 return code\nval logsSumDF \u003d not200DF.groupBy(\"path\").count()\n    .sort(desc(\"count\"))\n\nprintln(\"Top Ten failed URLs:\")\nlogsSumDF.show(10, false)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 14:01:07.105",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+-------------------+--------------------+------+------------+\n|                host|               time|                path|status|content_size|\n+--------------------+-------------------+--------------------+------+------------+\n| burger.letters.com |1995-07-01 00:00:11|/shuttle/countdow...|   304|           0|\n| burger.letters.com |1995-07-01 00:00:12|/images/NASA-logo...|   304|           0|\n|     129.94.144.152 |1995-07-01 00:00:17|/images/ksclogo-m...|   304|           0|\n|     205.189.154.54 |1995-07-01 00:01:06|/cgi-bin/imagemap...|   302|         110|\n|dd15-062.compuser...|1995-07-01 00:01:12|/news/sci.space.s...|   404|           0|\n| onyx.southwind.net |1995-07-01 00:01:39|/images/KSC-logos...|   304|           0|\n|remote27.compusma...|1995-07-01 00:01:53|/cgi-bin/imagemap...|   302|         110|\n|  netport-27.iu.net |1995-07-01 00:02:00|/images/ksclogo-m...|   304|           0|\n|  netport-27.iu.net |1995-07-01 00:02:01|/images/NASA-logo...|   304|           0|\n|  netport-27.iu.net |1995-07-01 00:02:01|/images/MOSAIC-lo...|   304|           0|\n+--------------------+-------------------+--------------------+------+------------+\nonly showing top 10 rows\n\nTop Ten failed URLs:\n+---------------------------------------+-----+\n|path                                   |count|\n+---------------------------------------+-----+\n|/images/NASA-logosmall.gif             |40090|\n|/images/KSC-logosmall.gif              |23763|\n|/images/MOSAIC-logosmall.gif           |15245|\n|/images/USA-logosmall.gif              |15142|\n|/images/WORLD-logosmall.gif            |14773|\n|/images/ksclogo-medium.gif             |13559|\n|/images/launch-logo.gif                |8806 |\n|/history/apollo/images/apollo-logo1.gif|7489 |\n|/                                      |6297 |\n|/images/ksclogosmall.gif               |5669 |\n+---------------------------------------+-----+\nonly showing top 10 rows\n\nval \u001b[1m\u001b[34mnot200DF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [host: string, time: timestamp ... 3 more fields]\nval \u001b[1m\u001b[34mlogsSumDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [path: string, count: bigint]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d64"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d65"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d66"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863463_1547693785",
      "id": "20180421-173433_1559948068",
      "dateCreated": "2025-03-30 13:37:43.463",
      "dateStarted": "2025-03-30 14:01:07.115",
      "dateFinished": "2025-03-30 14:01:07.712",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (4b) Exercise: Number of Unique Hosts\n\nHow many unique hosts are there in the entire log?\n\nThere are multiple ways to find this.  Try to find a more optimal way than grouping by \u0027host\u0027.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.463",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(4b) Exercise: Number of Unique Hosts\u003c/h3\u003e\n\u003cp\u003eHow many unique hosts are there in the entire log?\u003c/p\u003e\n\u003cp\u003eThere are multiple ways to find this.  Try to find a more optimal way than grouping by \u0026lsquo;host\u0026rsquo;.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863463_1001215221",
      "id": "20180422-055847_338196432",
      "dateCreated": "2025-03-30 13:37:43.463",
      "status": "READY"
    },
    {
      "text": "%spark\n// TODO: Replace \u003cFILL IN\u003e with appropriate code\n\nval uniqueHostCount \u003d logsDF.select(\"host\").distinct().count\nprintln(s\"Unique hosts: $uniqueHostCount\")",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 14:07:38.664",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[33mwarning: \u001b[0m1 deprecation (since 2.13.3); for details, enable `:setting -deprecation` or `:replay -deprecation`\nUnique hosts: 137979\nval \u001b[1m\u001b[34muniqueHostCount\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 137979\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d67"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d68"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d69"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863463_2046949576",
      "id": "20180422-055842_410189089",
      "dateCreated": "2025-03-30 13:37:43.463",
      "dateStarted": "2025-03-30 14:07:38.675",
      "dateFinished": "2025-03-30 14:07:40.031",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (4c) Exercise: Number of Unique Daily Hosts\n\nFor an advanced exercise, let\u0027s determine the number of unique hosts in the entire log on a day-by-day basis. This computation will give us counts of the number of unique daily hosts. We\u0027d like a DataFrame sorted by increasing day of the year which includes the day of the year and the associated number of unique hosts for that day. Make sure you cache the resulting DataFrame `dailyHostsDF` so that we can reuse it in the next exercise.\n\nThink about the steps that you need to perform to count the number of different hosts that make requests *each* day.\n*Since the log only covers a single year, you can ignore the year.*  You may want to use the [`dayofyear` function](https://spark.apache.org/docs/3.5.5/api/scala/org/apache/spark/sql/functions$.html#dayofyear(e:org.apache.spark.sql.Column):org.apache.spark.sql.Column) in the `org.apache.spark.sql.functions` module.\n\n**Description of each variable**\n\n**`dayToHostPairDF`**\n\nA DataFrame with two columns\n\n| column | explanation          |\n| ------ | -------------------- |\n| `host` | the host name        |\n| `day`  | the day of the year  |\n\nThere will be one row in this DataFrame for each row in `logsDF`. Essentially, you\u0027re just trimming and transforming each row of `logsDF`. For example, for this row in `logsDF`:\n\n```\ngw1.att.com - - [23/Aug/1995:00:03:53 -0400] \"GET /shuttle/missions/sts-73/news HTTP/1.0\" 302 -\n```\n\nyour `dayToHostPairDF` should have:\n\n```\ngw1.att.com 235\n```\n\n**`dayGroupHostsDF`**\n\nThis DataFrame has the same columns as `dayToHostPairDF`, but with duplicate (`day`, `host`) rows removed.\n\n**`dailyHostsDF`**\n\nA DataFrame with two columns:\n\n| column  | explanation                                        |\n| ------- | -------------------------------------------------- |\n| `day`   | the day of the year                                |\n| `count` | the number of unique requesting hosts for that day |",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.463",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(4c) Exercise: Number of Unique Daily Hosts\u003c/h3\u003e\n\u003cp\u003eFor an advanced exercise, let\u0026rsquo;s determine the number of unique hosts in the entire log on a day-by-day basis. This computation will give us counts of the number of unique daily hosts. We\u0026rsquo;d like a DataFrame sorted by increasing day of the year which includes the day of the year and the associated number of unique hosts for that day. Make sure you cache the resulting DataFrame \u003ccode\u003edailyHostsDF\u003c/code\u003e so that we can reuse it in the next exercise.\u003c/p\u003e\n\u003cp\u003eThink about the steps that you need to perform to count the number of different hosts that make requests \u003cem\u003eeach\u003c/em\u003e day.\u003cbr /\u003e\n\u003cem\u003eSince the log only covers a single year, you can ignore the year.\u003c/em\u003e  You may want to use the \u003ca href\u003d\"https://spark.apache.org/docs/3.5.5/api/scala/org/apache/spark/sql/functions$.html#dayofyear(e:org.apache.spark.sql.Column):org.apache.spark.sql.Column\"\u003e\u003ccode\u003edayofyear\u003c/code\u003e function\u003c/a\u003e in the \u003ccode\u003eorg.apache.spark.sql.functions\u003c/code\u003e module.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eDescription of each variable\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ccode\u003edayToHostPairDF\u003c/code\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eA DataFrame with two columns\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\u003cth\u003ecolumn\u003c/th\u003e\u003cth\u003eexplanation\u003c/th\u003e\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\u003ctd\u003e\u003ccode\u003ehost\u003c/code\u003e\u003c/td\u003e\u003ctd\u003ethe host name\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e\u003ccode\u003eday\u003c/code\u003e\u003c/td\u003e\u003ctd\u003ethe day of the year\u003c/td\u003e\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eThere will be one row in this DataFrame for each row in \u003ccode\u003elogsDF\u003c/code\u003e. Essentially, you\u0026rsquo;re just trimming and transforming each row of \u003ccode\u003elogsDF\u003c/code\u003e. For example, for this row in \u003ccode\u003elogsDF\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egw1.att.com - - [23/Aug/1995:00:03:53 -0400] \u0026quot;GET /shuttle/missions/sts-73/news HTTP/1.0\u0026quot; 302 -\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eyour \u003ccode\u003edayToHostPairDF\u003c/code\u003e should have:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egw1.att.com 235\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ccode\u003edayGroupHostsDF\u003c/code\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eThis DataFrame has the same columns as \u003ccode\u003edayToHostPairDF\u003c/code\u003e, but with duplicate (\u003ccode\u003eday\u003c/code\u003e, \u003ccode\u003ehost\u003c/code\u003e) rows removed.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ccode\u003edailyHostsDF\u003c/code\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eA DataFrame with two columns:\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\u003cth\u003ecolumn\u003c/th\u003e\u003cth\u003eexplanation\u003c/th\u003e\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\u003ctd\u003e\u003ccode\u003eday\u003c/code\u003e\u003c/td\u003e\u003ctd\u003ethe day of the year\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e\u003ccode\u003ecount\u003c/code\u003e\u003c/td\u003e\u003ctd\u003ethe number of unique requesting hosts for that day\u003c/td\u003e\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863463_850507139",
      "id": "20180422-055924_202110539",
      "dateCreated": "2025-03-30 13:37:43.463",
      "status": "READY"
    },
    {
      "text": "%spark\n// TODO: Replace \u003cFILL IN\u003e with appropriate code\n\nval dayToHostPairDF \u003d logsDF.select(col(\"host\"), dayofyear(col(\"time\")).alias(\"day\"))\nval dayGroupHostsDF \u003d dayToHostPairDF.distinct()\nval dailyHostsDF \u003d dayGroupHostsDF.groupBy(\"day\").count().withColumnRenamed(\"count\", \"host_count\").sort(\"day\")\n\nprintln(\"Unique hosts per day:\")\ndailyHostsDF.show(30, false)\ndailyHostsDF.cache()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 14:44:40.196",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Unique hosts per day:\n+---+----------+\n|day|host_count|\n+---+----------+\n|182|5192      |\n|183|4859      |\n|184|7336      |\n|185|5524      |\n|186|7383      |\n|187|7820      |\n|188|6474      |\n|189|2898      |\n|190|2554      |\n|191|4464      |\n|192|4927      |\n|193|5345      |\n|194|6951      |\n|195|5297      |\n|196|3116      |\n|197|3013      |\n|198|4943      |\n|199|4523      |\n|200|4919      |\n|201|4729      |\n|202|4339      |\n|203|2575      |\n|204|2635      |\n|205|4298      |\n|206|4376      |\n|207|4296      |\n|208|4368      |\n|209|2175      |\n|213|2583      |\n|215|3222      |\n+---+----------+\nonly showing top 30 rows\n\nval \u001b[1m\u001b[34mdayToHostPairDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [host: string, day: int]\nval \u001b[1m\u001b[34mdayGroupHostsDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [host: string, day: int]\nval \u001b[1m\u001b[34mdailyHostsDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [day: int, host_count: bigint]\nval \u001b[1m\u001b[34mres57\u001b[0m: \u001b[1m\u001b[32mdailyHostsDF.type\u001b[0m \u003d [day: int, host_count: bigint]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d115"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863463_63821636",
      "id": "20180422-055920_1516411764",
      "dateCreated": "2025-03-30 13:37:43.463",
      "dateStarted": "2025-03-30 14:44:40.206",
      "dateFinished": "2025-03-30 14:44:40.642",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (4d) Exercise: Visualizing the Number of Unique Daily Hosts\n\nUsing the results from the previous exercise, we will use Zeppelin\u0027s built-in visualization to plot a bar graph of the unique hosts requests by day. ",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.463",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(4d) Exercise: Visualizing the Number of Unique Daily Hosts\u003c/h3\u003e\n\u003cp\u003eUsing the results from the previous exercise, we will use Zeppelin\u0026rsquo;s built-in visualization to plot a bar graph of the unique hosts requests by day.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863463_1506855133",
      "id": "20180422-060450_169550538",
      "dateCreated": "2025-03-30 13:37:43.463",
      "status": "READY"
    },
    {
      "text": "%spark\n// TODO: Your solution goes here\n\nz.show(dailyHostsDF)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 14:21:58.193",
      "progress": 32,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {
          "0": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default",
                  "stacked": false
                }
              },
              "keys": [
                {
                  "name": "day",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "count",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "day\tcount\n182\t5192\n183\t4859\n184\t7336\n185\t5524\n186\t7383\n187\t7820\n188\t6474\n189\t2898\n190\t2554\n191\t4464\n192\t4927\n193\t5345\n194\t6951\n195\t5297\n196\t3116\n197\t3013\n198\t4943\n199\t4523\n200\t4919\n201\t4729\n202\t4339\n203\t2575\n204\t2635\n205\t4298\n206\t4376\n207\t4296\n208\t4368\n209\t2175\n213\t2583\n215\t3222\n216\t4191\n217\t2502\n218\t2538\n219\t4108\n220\t4406\n221\t4317\n222\t4523\n223\t4346\n224\t2865\n225\t2650\n226\t4454\n227\t4214\n228\t4340\n229\t4385\n230\t4168\n231\t2550\n232\t2560\n233\t4135\n234\t4456\n235\t4368\n236\t4077\n237\t4407\n238\t2644\n239\t2690\n240\t4215\n241\t4826\n242\t5266\n243\t5916\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d95"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d96"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d97"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d98"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863463_1367579900",
      "id": "20180422-060438_1745266546",
      "dateCreated": "2025-03-30 13:37:43.463",
      "dateStarted": "2025-03-30 14:21:58.203",
      "dateFinished": "2025-03-30 14:21:59.116",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (4e) Exercise: Average Number of Daily Requests per Host\n\nNext, let\u0027s determine the average number of requests on a day-by-day basis.  We\u0027d like a list by increasing day of the year and the associated average number of requests per host for that day. Make sure you cache the resulting DataFrame `avg_daily_req_per_host_df` so that we can reuse it in the next exercise.\n\nTo compute the average number of requests per host, find the total number of requests per day (across all hosts) and divide that by the number of unique hosts per day (which we found in part 4c and cached as `daily_hosts_df`).\n\n*Since the log only covers a single year, you can ignore the year.*",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 14:22:30.423",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(4e) Exercise: Average Number of Daily Requests per Host\u003c/h3\u003e\n\u003cp\u003eNext, let\u0026rsquo;s determine the average number of requests on a day-by-day basis.  We\u0026rsquo;d like a list by increasing day of the year and the associated average number of requests per host for that day. Make sure you cache the resulting DataFrame \u003ccode\u003eavg_daily_req_per_host_df\u003c/code\u003e so that we can reuse it in the next exercise.\u003c/p\u003e\n\u003cp\u003eTo compute the average number of requests per host, find the total number of requests per day (across all hosts) and divide that by the number of unique hosts per day (which we found in part 4c and cached as \u003ccode\u003edaily_hosts_df\u003c/code\u003e).\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eSince the log only covers a single year, you can ignore the year.\u003c/em\u003e\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863463_2130143106",
      "id": "20180422-060546_228439370",
      "dateCreated": "2025-03-30 13:37:43.463",
      "dateStarted": "2025-03-30 14:22:30.423",
      "dateFinished": "2025-03-30 14:22:32.687",
      "status": "FINISHED"
    },
    {
      "text": "%spark\n\n\nval totalReqPerDayDF \u003d logsDF.select( dayofyear(col(\"time\")).alias(\"day\")).groupBy(\"day\").count().withColumnRenamed(\"count\", \"total_count\").sort(\"day\")\n\nval renamedTotalReqPerDayDF \u003d totalReqPerDayDF\nval renamedDailyHostsDF \u003d dailyHostsDF\nval avgDailyReqPerHostDF \u003d \n   totalReqPerDayDF.join(dailyHostsDF, Seq(\"day\"))  .select(\n    col(\"day\"),\n    (col(\"total_count\") / col(\"host_count\")).alias(\"ratio\")\n  )\n\nprintln(\"Average number of daily requests per Hosts is:\")\n\navgDailyReqPerHostDF.show()\navgDailyReqPerHostDF.cache()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 14:45:43.699",
      "progress": 18,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Average number of daily requests per Hosts is:\n+---+------------------+\n|day|             ratio|\n+---+------------------+\n|243|15.234110885733603|\n|193|17.312628624883068|\n|183| 12.40275776908829|\n|192|16.319667140247613|\n|236|12.889870002452783|\n|223|14.092498849516797|\n|222|13.541454786646032|\n|209|12.469425287356321|\n|230|13.494721689059501|\n|190|13.810493343774471|\n|225|13.766037735849057|\n|232|      12.876171875|\n|233|  13.4316807738815|\n|224|13.288307155322862|\n|185|12.753801593048516|\n|206| 14.32792504570384|\n|182|12.464175654853621|\n|218| 12.77383766745469|\n|205|14.950907398790134|\n|235|13.300595238095237|\n+---+------------------+\nonly showing top 20 rows\n\nval \u001b[1m\u001b[34mtotalReqPerDayDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [day: int, total_count: bigint]\nval \u001b[1m\u001b[34mrenamedTotalReqPerDayDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [day: int, total_count: bigint]\nval \u001b[1m\u001b[34mrenamedDailyHostsDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [day: int, host_count: bigint]\nval \u001b[1m\u001b[34mavgDailyReqPerHostDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [day: int, ratio: double]\nval \u001b[1m\u001b[34mres59\u001b[0m: \u001b[1m\u001b[32mavgDailyReqPerHostDF.type\u001b[0m \u003d [day: int, ratio: double]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d118"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d119"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d120"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d121"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d122"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d123"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863464_1067807107",
      "id": "20180422-060524_1976872568",
      "dateCreated": "2025-03-30 13:37:43.464",
      "dateStarted": "2025-03-30 14:45:43.715",
      "dateFinished": "2025-03-30 14:45:45.208",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (4f) Exercise: Visualizing the Average Daily Requests per Unique Host\n\nUsing the result `avgDailyReqPerHostDF` from the previous exercise, use Zeppelin\u0027s built-in visualization to plot a bar graph of the average daily requests per unique host by day.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.464",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(4f) Exercise: Visualizing the Average Daily Requests per Unique Host\u003c/h3\u003e\n\u003cp\u003eUsing the result \u003ccode\u003eavgDailyReqPerHostDF\u003c/code\u003e from the previous exercise, use Zeppelin\u0026rsquo;s built-in visualization to plot a bar graph of the average daily requests per unique host by day.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863464_1086530309",
      "id": "20180422-060622_1103426732",
      "dateCreated": "2025-03-30 13:37:43.464",
      "status": "READY"
    },
    {
      "text": "%spark\n// TODO: Replace \u003cFILL IN\u003e with appropriate code\n\nz.show(avgDailyReqPerHostDF)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 14:46:05.329",
      "progress": 75,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {
          "0": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300.0,
              "optionOpen": false
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "day\tratio\n243\t15.234110885733603\n193\t17.312628624883068\n183\t12.40275776908829\n192\t16.319667140247613\n236\t12.889870002452783\n223\t14.092498849516797\n222\t13.541454786646032\n209\t12.469425287356321\n230\t13.494721689059501\n190\t13.810493343774471\n225\t13.766037735849057\n232\t12.876171875\n233\t13.4316807738815\n224\t13.288307155322862\n185\t12.753801593048516\n206\t14.32792504570384\n182\t12.464175654853621\n218\t12.77383766745469\n205\t14.950907398790134\n235\t13.300595238095237\n191\t16.32168458781362\n227\t13.964641670621736\n189\t13.411663216011043\n207\t13.698556797020483\n197\t15.882509127115831\n202\t14.894906660520858\n231\t12.585882352941177\n196\t14.61232349165597\n217\t12.747002398081534\n229\t13.452223489167617\n220\t13.653427144802542\n241\t14.087857438872772\n238\t11.954614220877458\n194\t19.307006186160265\n234\t12.962746858168762\n239\t12.20185873605948\n216\t14.210689572894298\n240\t13.166310794780546\n237\t13.006807351940095\n219\t13.9634858812074\n226\t13.443646160754378\n195\t15.877477817632622\n203\t13.695922330097087\n221\t14.00463284688441\n200\t14.787151860134173\n213\t13.161440185830429\n228\t13.0536866359447\n188\t13.474358974358974\n204\t14.876280834914612\n198\t15.169128059882663\n199\t14.212248507627681\n242\t15.313520698822636\n201\t14.081835483188835\n184\t12.211559432933479\n186\t12.809833401056482\n215\t12.845437616387336\n187\t12.910485933503836\n208\t14.12087912087912\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d124"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d125"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d126"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d127"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863464_905371114",
      "id": "20180422-060619_2083974369",
      "dateCreated": "2025-03-30 13:37:43.464",
      "dateStarted": "2025-03-30 14:46:05.339",
      "dateFinished": "2025-03-30 14:46:06.667",
      "status": "FINISHED"
    },
    {
      "text": "%md\n## Part 5: Exercises - Exploring 404 Status Codes\n\nLet\u0027s drill down and explore the error 404 status records. We\u0027ve all seen those \"404 Not Found\" web pages. 404 errors are returned when the server cannot find the resource (page or object) the browser or client requested.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.464",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003ePart 5: Exercises - Exploring 404 Status Codes\u003c/h2\u003e\n\u003cp\u003eLet\u0026rsquo;s drill down and explore the error 404 status records. We\u0026rsquo;ve all seen those \u0026ldquo;404 Not Found\u0026rdquo; web pages. 404 errors are returned when the server cannot find the resource (page or object) the browser or client requested.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863464_1174945853",
      "id": "20180422-112330_101630495",
      "dateCreated": "2025-03-30 13:37:43.464",
      "status": "READY"
    },
    {
      "text": "%md\n### (5a) Exercise: Counting 404 Response Codes\n\nCreate a DataFrame containing only log records with a 404 status code. Make sure you `cache()` `notFoundDF` as we will use it in the rest of this exercise.\n\nHow many 404 records are in the log?",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.464",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(5a) Exercise: Counting 404 Response Codes\u003c/h3\u003e\n\u003cp\u003eCreate a DataFrame containing only log records with a 404 status code. Make sure you \u003ccode\u003ecache()\u003c/code\u003e \u003ccode\u003enotFoundDF\u003c/code\u003e as we will use it in the rest of this exercise.\u003c/p\u003e\n\u003cp\u003eHow many 404 records are in the log?\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863464_1422301128",
      "id": "20180422-112418_950162214",
      "dateCreated": "2025-03-30 13:37:43.464",
      "status": "READY"
    },
    {
      "text": "%spark\n// TODO: Replace \u003cFILL IN\u003e with appropriate code\n\nval notFoundDF \u003d logsDF\n    .filter(col(\"status\") \u003d\u003d\u003d 404).cache\nprintln(s\"Found ${notFoundDF.count()} 404 URLs\")",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 14:48:30.527",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[33mwarning: \u001b[0m1 deprecation (since 2.13.3); for details, enable `:setting -deprecation` or `:replay -deprecation`\nFound 20901 404 URLs\nval \u001b[1m\u001b[34mnotFoundDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [host: string, time: timestamp ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d135"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d136"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863464_515264171",
      "id": "20180422-112209_721776736",
      "dateCreated": "2025-03-30 13:37:43.464",
      "dateStarted": "2025-03-30 14:48:30.544",
      "dateFinished": "2025-03-30 14:48:30.668",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (5b) Exercise: Listing 404 Status Code Records\n\nUsing the DataFrame containing only log records with a 404 status code that you cached in part (5a), print out a list up to 40 _distinct_ paths that generate 404 errors.\n\n**No path should appear more than once in your list.**",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.464",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(5b) Exercise: Listing 404 Status Code Records\u003c/h3\u003e\n\u003cp\u003eUsing the DataFrame containing only log records with a 404 status code that you cached in part (5a), print out a list up to 40 \u003cem\u003edistinct\u003c/em\u003e paths that generate 404 errors.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eNo path should appear more than once in your list.\u003c/strong\u003e\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863464_1422683716",
      "id": "20180422-112515_1898857749",
      "dateCreated": "2025-03-30 13:37:43.464",
      "status": "READY"
    },
    {
      "text": "%spark\nnotFoundDF.show()\n",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 14:49:36.850",
      "progress": 0,
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "results": {},
        "enabled": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionSupport": true,
          "completionKey": "TAB"
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+-------------------+--------------------+------+------------+\n|                host|               time|                path|status|content_size|\n+--------------------+-------------------+--------------------+------+------------+\n|dd15-062.compuser...|1995-07-01 00:01:12|/news/sci.space.s...|   404|           0|\n|  netport-27.iu.net |1995-07-01 00:10:19|/pub/winvn/readme...|   404|           0|\n|  netport-27.iu.net |1995-07-01 00:10:28|/pub/winvn/readme...|   404|           0|\n|blv-pm0-ip28.halc...|1995-07-01 00:14:17|/persons/astronau...|   404|           0|\n|blv-pm0-ip28.halc...|1995-07-01 00:14:32|/persons/astronau...|   404|           0|\n|cu-dialup-1005.ci...|1995-07-01 00:18:39|/pub/winvn/readme...|   404|           0|\n|cu-dialup-1005.ci...|1995-07-01 00:18:45|/pub/winvn/readme...|   404|           0|\n|cu-dialup-1005.ci...|1995-07-01 00:18:49|/pub/winvn/releas...|   404|           0|\n|   mimas.execpc.com |1995-07-01 00:18:59|/shuttle/missions...|   404|           0|\n|zoom112.telepath....|1995-07-01 00:25:27|/history/apollo-1...|   404|           0|\n|ad08-027.compuser...|1995-07-01 00:37:55|/shuttle/missions...|   404|           0|\n|ad08-027.compuser...|1995-07-01 00:38:02|/shuttle/missions...|   404|           0|\n|piweba3y.prodigy....|1995-07-01 00:44:27|/shuttle/missions...|   404|           0|\n|piweba3y.prodigy....|1995-07-01 00:44:47|/shuttle/missions...|   404|           0|\n|    204.212.153.234 |1995-07-01 00:45:16|/pub/winvn/readme...|   404|           0|\n|    204.212.153.234 |1995-07-01 00:45:26|/pub/winvn/releas...|   404|           0|\n|ix-wbg-va2-26.ix....|1995-07-01 00:45:45|/history/apollo/p...|   404|           0|\n|ix-wbg-va2-26.ix....|1995-07-01 00:45:56|/history/apollo/p...|   404|           0|\n|ix-wbg-va2-26.ix....|1995-07-01 00:46:05|/history/apollo/p...|   404|           0|\n|ix-wbg-va2-26.ix....|1995-07-01 00:46:09|/history/apollo/p...|   404|           0|\n+--------------------+-------------------+--------------------+------+------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d137"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743346165264_1337074324",
      "id": "paragraph_1743346165264_1337074324",
      "dateCreated": "2025-03-30 14:49:25.265",
      "dateStarted": "2025-03-30 14:49:36.860",
      "dateFinished": "2025-03-30 14:49:36.977",
      "status": "FINISHED"
    },
    {
      "text": "%spark\n// TODO: Replace \u003cFILL IN\u003e with appropriate code\n\nval notFoundPathsDF \u003d notFoundDF.select(\"path\")\nval uniqueNotFoundPathsDF \u003d notFoundPathsDF.distinct()\n\nprintln(\"404 URLS:\")\nuniqueNotFoundPathsDF.show(numRows \u003d 40, truncate \u003d false)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 14:50:00.956",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "404 URLS:\n+-----------------------------------------------------------------+\n|path                                                             |\n+-----------------------------------------------------------------+\n|/history/apollo/a-001/news/                                      |\n|/shuttle/missions/sts-68/images/images.html                      |\n|/history/apollo/apollo-13/apollo-13.html)                        |\n|/shuttle/sts-71/movies                                           |\n|/shuttle/missions/sts-77/ht                                      |\n|/htbin/freq                                                      |\n|/Harvest/brokers/WWW/stats.html                                  |\n|/home/guided-tour.html                                           |\n|/shuttle/technology/sts-newsref/sts_sys.html#sts-flag            |\n|/history/apollo/a-003/movies/                                    |\n|/shuttle/technology/sts-newsref/sts_overview.ht                  |\n|/local                                                           |\n|/software///icons/menu.xbm                                       |\n|/software//viewers/icons/blank.xbm                               |\n|/CSMT_PageNS                                                     |\n|/missions/shuttle                                                |\n|/shuttle/technology/sts-newsref/stsret-newsref/stsref-toc.html   |\n|/fia/projects/bayes-group/Atlas/Earth/                           |\n|/shuttle/mission/missions.html                                   |\n|/shuttle/technology/sts.newsref/stsref-tof.html                  |\n|/shuttle/missions/sts-71/news/sts-71-mcc-9.txt                   |\n|/History/Apollo/Apollo13/Apollo.html                             |\n|/voyager/bundy:hshshs                                            |\n|/WWW.html                                                        |\n|/shuttle/mission/41-d/mission-41-d.html                          |\n|/GIF/nasaball.gif                                                |\n|/shuttle/missions/sts.71/movies                                  |\n|/MDSS.html                                                       |\n|/shuttle/technology/sts-newsref/stsover-launch.html#stsover-orbit|\n|/history/apollo/apollo14/apollo14.html                           |\n|/shuttle/missions/sts-70/movies/movies.html5                     |\n|/shuttle/missions/sts-71/news/ksc-status-07-01-95.txt            |\n|/history/apollo/images/apollo.html                               |\n|/first.html                                                      |\n|/shuttle/missions/sts-34/mission-sts-34.html\"\u003e\u003cIMG               |\n|/pub/wiinvn/win3/ww16_99_.zip                                    |\n|/public.win3/winvn                                               |\n|/shuttle/sts-1/sts-1-pa.jpg                                      |\n|/history/apollo/apollo/13                                        |\n|/shuttle/missions/sts-61-a/images/                               |\n+-----------------------------------------------------------------+\nonly showing top 40 rows\n\nval \u001b[1m\u001b[34mnotFoundPathsDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [path: string]\nval \u001b[1m\u001b[34muniqueNotFoundPathsDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [path: string]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d138"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d139"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863464_1465117909",
      "id": "20180422-112512_1657859267",
      "dateCreated": "2025-03-30 13:37:43.464",
      "dateStarted": "2025-03-30 14:50:00.966",
      "dateFinished": "2025-03-30 14:50:01.262",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (5c) Exercise: Listing the Top Twenty 404 Response Code paths\n\nUsing the DataFrame containing only log records with a 404 response code that you cached in part (5a), print out a list of the top twenty paths that generate the most 404 errors.\n\n*Remember, top paths should be in sorted order*",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.464",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(5c) Exercise: Listing the Top Twenty 404 Response Code paths\u003c/h3\u003e\n\u003cp\u003eUsing the DataFrame containing only log records with a 404 response code that you cached in part (5a), print out a list of the top twenty paths that generate the most 404 errors.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eRemember, top paths should be in sorted order\u003c/em\u003e\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863464_50433201",
      "id": "20180422-112613_520304247",
      "dateCreated": "2025-03-30 13:37:43.464",
      "status": "READY"
    },
    {
      "text": "%spark\n// TODO: Replace \u003cFILL IN\u003e with appropriate code\n\nval top20NotFoundDF \u003d notFoundPathsDF.groupBy(\"path\").count().sort(desc(\"count\"))\n\nprintln(\"Top Twenty 404 URLs:\")\ntop20NotFoundDF.show(numRows \u003d 20, truncate \u003d false)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 14:52:17.885",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Top Twenty 404 URLs:\n+-----------------------------------------------------------------+-----+\n|path                                                             |count|\n+-----------------------------------------------------------------+-----+\n|/pub/winvn/readme.txt                                            |2004 |\n|/pub/winvn/release.txt                                           |1732 |\n|/shuttle/missions/STS-69/mission-STS-69.html                     |683  |\n|/shuttle/missions/sts-68/ksc-upclose.gif                         |428  |\n|/history/apollo/a-001/a-001-patch-small.gif                      |384  |\n|/history/apollo/sa-1/sa-1-patch-small.gif                        |383  |\n|/://spacelink.msfc.nasa.gov                                      |381  |\n|/images/crawlerway-logo.gif                                      |374  |\n|/elv/DELTA/uncons.htm                                            |372  |\n|/history/apollo/pad-abort-test-1/pad-abort-test-1-patch-small.gif|359  |\n|/images/nasa-logo.gif                                            |319  |\n|/shuttle/resources/orbiters/atlantis.gif                         |314  |\n|/history/apollo/apollo-13.html                                   |304  |\n|/shuttle/resources/orbiters/discovery.gif                        |263  |\n|/shuttle/missions/sts-71/images/KSC-95EC-0916.txt                |190  |\n|/shuttle/resources/orbiters/challenger.gif                       |170  |\n|/shuttle/missions/technology/sts-newsref/stsref-toc.html         |158  |\n|/history/apollo/images/little-joe.jpg                            |150  |\n|/images/lf-logo.gif                                              |143  |\n|/history/apollo/publications/sp-350/sp-350.txt~                  |140  |\n+-----------------------------------------------------------------+-----+\nonly showing top 20 rows\n\nval \u001b[1m\u001b[34mtop20NotFoundDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [path: string, count: bigint]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d146"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d147"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863464_1459288289",
      "id": "20180422-112600_589209340",
      "dateCreated": "2025-03-30 13:37:43.464",
      "dateStarted": "2025-03-30 14:52:17.895",
      "dateFinished": "2025-03-30 14:52:18.128",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (5d) Exercise: Listing the Top Twenty-five 404 Response Code Hosts\n\nInstead of looking at the paths that generated 404 errors, let\u0027s look at the hosts that encountered 404 errors. Using the DataFrame containing only log records with a 404 status codes that you cached in part (5a), print out a list of the top twenty-five hosts that generate the most 404 errors.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.464",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(5d) Exercise: Listing the Top Twenty-five 404 Response Code Hosts\u003c/h3\u003e\n\u003cp\u003eInstead of looking at the paths that generated 404 errors, let\u0026rsquo;s look at the hosts that encountered 404 errors. Using the DataFrame containing only log records with a 404 status codes that you cached in part (5a), print out a list of the top twenty-five hosts that generate the most 404 errors.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863464_1470933389",
      "id": "20180422-112651_772838241",
      "dateCreated": "2025-03-30 13:37:43.464",
      "status": "READY"
    },
    {
      "text": "%spark\n// TODO: Replace \u003cFILL IN\u003e with appropriate code\n\nval hosts404CountDF \u003d notFoundDF.groupBy(\"host\").count().sort(desc(\"count\"))\n\nprintln(\"Top 25 hosts that generated errors:\")\nhosts404CountDF.show(numRows \u003d 25, truncate \u003d false)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 14:56:04.354",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Top 25 hosts that generated errors:\n+----------------------------+-----+\n|host                        |count|\n+----------------------------+-----+\n|hoohoo.ncsa.uiuc.edu        |251  |\n|piweba3y.prodigy.com        |157  |\n|jbiagioni.npt.nuwc.navy.mil |132  |\n|piweba1y.prodigy.com        |114  |\n|www-d4.proxy.aol.com        |91   |\n|piweba4y.prodigy.com        |86   |\n|scooter.pa-x.dec.com        |69   |\n|www-d1.proxy.aol.com        |64   |\n|phaelon.ksc.nasa.gov        |64   |\n|www-b4.proxy.aol.com        |62   |\n|dialip-217.den.mmc.com      |62   |\n|www-b3.proxy.aol.com        |61   |\n|www-a2.proxy.aol.com        |60   |\n|titan02f                    |59   |\n|www-d2.proxy.aol.com        |59   |\n|piweba2y.prodigy.com        |59   |\n|alyssa.prodigy.com          |56   |\n|monarch.eng.buffalo.edu     |56   |\n|www-c4.proxy.aol.com        |53   |\n|www-b2.proxy.aol.com        |53   |\n|www-d3.proxy.aol.com        |52   |\n|www-b5.proxy.aol.com        |50   |\n|www-a1.proxy.aol.com        |50   |\n|www-c2.proxy.aol.com        |49   |\n|www-b6.proxy.aol.com        |48   |\n+----------------------------+-----+\nonly showing top 25 rows\n\nval \u001b[1m\u001b[34mhosts404CountDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [host: string, count: bigint]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d152"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d153"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863464_885063552",
      "id": "20180422-112641_1690112687",
      "dateCreated": "2025-03-30 13:37:43.465",
      "dateStarted": "2025-03-30 14:56:04.364",
      "dateFinished": "2025-03-30 14:56:04.703",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (5e) Exercise: Listing 404 Errors per Day\n\nLet\u0027s explore the 404 records temporally. Break down the 404 requests by day (cache the `errorsByDateSortedDF` DataFrame) and get the daily counts sorted by day in `errorsByDateSortedDF`.\n\n*Since the log only covers a single year, you can ignore the year in your checks.*",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.465",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(5e) Exercise: Listing 404 Errors per Day\u003c/h3\u003e\n\u003cp\u003eLet\u0026rsquo;s explore the 404 records temporally. Break down the 404 requests by day (cache the \u003ccode\u003eerrorsByDateSortedDF\u003c/code\u003e DataFrame) and get the daily counts sorted by day in \u003ccode\u003eerrorsByDateSortedDF\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eSince the log only covers a single year, you can ignore the year in your checks.\u003c/em\u003e\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863465_1661448133",
      "id": "20180422-112722_59445491",
      "dateCreated": "2025-03-30 13:37:43.465",
      "status": "READY"
    },
    {
      "text": "%spark\n// TODO: Replace \u003cFILL IN\u003e with appropriate code\n\nval errorsByDateSortedDF \u003d notFoundDF.groupBy(dayofyear(col(\"time\"))).count().withColumnRenamed(\"dayofyear(time)\",\"day\").sort(\"day\").cache()\n\nprintln(\"404 Errors by day:\")\nerrorsByDateSortedDF.show()",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 15:03:13.109",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "404 Errors by day:\n+---+-----+\n|day|count|\n+---+-----+\n|182|  316|\n|183|  291|\n|184|  474|\n|185|  359|\n|186|  497|\n|187|  640|\n|188|  570|\n|189|  302|\n|190|  348|\n|191|  398|\n|192|  471|\n|193|  471|\n|194|  532|\n|195|  413|\n|196|  254|\n|197|  257|\n|198|  406|\n|199|  465|\n|200|  639|\n|201|  428|\n+---+-----+\nonly showing top 20 rows\n\nval \u001b[1m\u001b[34merrorsByDateSortedDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [day: int, count: bigint]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d177"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d178"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d179"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863465_2061959692",
      "id": "20180422-112719_1129420945",
      "dateCreated": "2025-03-30 13:37:43.465",
      "dateStarted": "2025-03-30 15:03:13.120",
      "dateFinished": "2025-03-30 15:03:13.355",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (5f) Exercise: Visualizing the 404 Errors by Day\n\nUsing the results from the previous exercise, use Zeppelin\u0027s built-in visualization to plot a line or bar graph of the 404 response codes by day.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.465",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(5f) Exercise: Visualizing the 404 Errors by Day\u003c/h3\u003e\n\u003cp\u003eUsing the results from the previous exercise, use Zeppelin\u0026rsquo;s built-in visualization to plot a line or bar graph of the 404 response codes by day.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863465_371072535",
      "id": "20180422-112832_799055173",
      "dateCreated": "2025-03-30 13:37:43.465",
      "status": "READY"
    },
    {
      "text": "%spark\n// TODO: Replace \u003cFILL IN\u003e with appropriate code\n\nz.show(errorsByDateSortedDF)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 15:01:15.109",
      "progress": 29,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {
          "0": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300.0,
              "optionOpen": false
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "day\tcount\n182\t316\n183\t291\n184\t474\n185\t359\n186\t497\n187\t640\n188\t570\n189\t302\n190\t348\n191\t398\n192\t471\n193\t471\n194\t532\n195\t413\n196\t254\n197\t257\n198\t406\n199\t465\n200\t639\n201\t428\n202\t334\n203\t192\n204\t233\n205\t328\n206\t461\n207\t336\n208\t336\n209\t94\n213\t243\n215\t304\n216\t346\n217\t236\n218\t373\n219\t537\n220\t391\n221\t279\n222\t315\n223\t263\n224\t196\n225\t216\n226\t287\n227\t327\n228\t259\n229\t271\n230\t256\n231\t209\n232\t312\n233\t305\n234\t288\n235\t345\n236\t420\n237\t415\n238\t366\n239\t370\n240\t410\n241\t420\n242\t571\n243\t526\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d172"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d173"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d174"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d175"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863465_1982350042",
      "id": "20180422-112827_224839510",
      "dateCreated": "2025-03-30 13:37:43.465",
      "dateStarted": "2025-03-30 15:01:15.120",
      "dateFinished": "2025-03-30 15:01:15.871",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (5g) Exercise: Top Five Days for 404 Errors\n\nUsing the DataFrame `errorsByDateSortedDF` you cached in the part (5e), what are the top five days for 404 errors and the corresponding counts of 404 errors?",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.465",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(5g) Exercise: Top Five Days for 404 Errors\u003c/h3\u003e\n\u003cp\u003eUsing the DataFrame \u003ccode\u003eerrorsByDateSortedDF\u003c/code\u003e you cached in the part (5e), what are the top five days for 404 errors and the corresponding counts of 404 errors?\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863465_167656591",
      "id": "20180422-112907_633711915",
      "dateCreated": "2025-03-30 13:37:43.465",
      "status": "READY"
    },
    {
      "text": "%spark\n// TODO: Replace \u003cFILL IN\u003e with appropriate code\n\nval topErrDateDF \u003d errorsByDateSortedDF.sort(desc(\"count\"))\n\nprintln(\"Top Five Dates for 404 Requests:\")\ntopErrDateDF.show(5)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 15:02:21.345",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Top Five Dates for 404 Requests:\n+---+-----+\n|day|count|\n+---+-----+\n|187|  640|\n|200|  639|\n|242|  571|\n|188|  570|\n|219|  537|\n+---+-----+\nonly showing top 5 rows\n\nval \u001b[1m\u001b[34mtopErrDateDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [day: int, count: bigint]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d176"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863465_2051514561",
      "id": "20180422-112904_64414930",
      "dateCreated": "2025-03-30 13:37:43.465",
      "dateStarted": "2025-03-30 15:02:21.360",
      "dateFinished": "2025-03-30 15:02:21.638",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (5h) Exercise: Hourly 404 Errors\n\nUsing the DataFrame `notFoundDF` you cached in the part (5a) and sorting by hour of the day in increasing order, create a DataFrame containing the number of requests that had a 404 return code for each hour of the day (midnight starts at 0). Cache the resulting DataFrame `hourRecordsSortedDF` and print that as a list.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.465",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(5h) Exercise: Hourly 404 Errors\u003c/h3\u003e\n\u003cp\u003eUsing the DataFrame \u003ccode\u003enotFoundDF\u003c/code\u003e you cached in the part (5a) and sorting by hour of the day in increasing order, create a DataFrame containing the number of requests that had a 404 return code for each hour of the day (midnight starts at 0). Cache the resulting DataFrame \u003ccode\u003ehourRecordsSortedDF\u003c/code\u003e and print that as a list.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863465_1405301018",
      "id": "20180422-113025_1864632081",
      "dateCreated": "2025-03-30 13:37:43.465",
      "status": "READY"
    },
    {
      "text": "%spark\n// TODO: Replace \u003cFILL IN\u003e with appropriate code\nimport org.apache.spark.sql.functions.hour\nval hourRecordsSortedDF \u003d notFoundDF.groupBy(hour(col(\"time\"))).count().withColumnRenamed(\"hour(time)\",\"hour\").sort(\"hour\").cache()\n\nprintln(\"Top hours for 404 requests:\")\nhourRecordsSortedDF\nhourRecordsSortedDF.show(24)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 15:09:37.732",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "       hourRecordsSortedDF\n       ^\nOn line 7: \u001b[33mwarning: \u001b[0ma pure expression does nothing in statement position; multiline expressions may require enclosing parentheses\nTop hours for 404 requests:\n+----+-----+\n|hour|count|\n+----+-----+\n|   0|  774|\n|   1|  648|\n|   2|  868|\n|   3|  603|\n|   4|  351|\n|   5|  307|\n|   6|  269|\n|   7|  458|\n|   8|  705|\n|   9|  840|\n|  10| 1087|\n|  11| 1160|\n|  12| 1308|\n|  13| 1151|\n|  14| 1274|\n|  15| 1382|\n|  16| 1181|\n|  17| 1203|\n|  18|  930|\n|  19|  852|\n|  20|  815|\n|  21|  879|\n|  22|  915|\n|  23|  941|\n+----+-----+\n\nimport org.apache.spark.sql.functions.hour\nval \u001b[1m\u001b[34mhourRecordsSortedDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [hour: int, count: bigint]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d185"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d186"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d187"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d188"
            },
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d189"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863465_1647632754",
      "id": "20180422-113021_95653868",
      "dateCreated": "2025-03-30 13:37:43.465",
      "dateStarted": "2025-03-30 15:09:37.745",
      "dateFinished": "2025-03-30 15:09:38.110",
      "status": "FINISHED"
    },
    {
      "text": "%md\n### (5i) Exercise: Visualizing the 404 Response Codes by Hour\n\nUsing the results from the previous exercise, use Zeppelin\u0027s built-in visualization to plot a line or bar graph of the 404 response codes by hour.",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 13:37:43.465",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003e(5i) Exercise: Visualizing the 404 Response Codes by Hour\u003c/h3\u003e\n\u003cp\u003eUsing the results from the previous exercise, use Zeppelin\u0026rsquo;s built-in visualization to plot a line or bar graph of the 404 response codes by hour.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863465_441230424",
      "id": "20180422-113125_1310237478",
      "dateCreated": "2025-03-30 13:37:43.465",
      "status": "READY"
    },
    {
      "text": "%spark\n// TODO: Replace \u003cFILL IN\u003e with appropriate code\n\nz.show(hourRecordsSortedDF)",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 15:09:56.550",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {
          "0": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300.0,
              "optionOpen": false
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "hour\tcount\n0\t774\n1\t648\n2\t868\n3\t603\n4\t351\n5\t307\n6\t269\n7\t458\n8\t705\n9\t840\n10\t1087\n11\t1160\n12\t1308\n13\t1151\n14\t1274\n15\t1382\n16\t1181\n17\t1203\n18\t930\n19\t852\n20\t815\n21\t879\n22\t915\n23\t941\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://localhost:4040/jobs/job?id\u003d190"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743341863465_390217003",
      "id": "20180422-113123_1125579055",
      "dateCreated": "2025-03-30 13:37:43.465",
      "dateStarted": "2025-03-30 15:09:56.562",
      "dateFinished": "2025-03-30 15:09:56.704",
      "status": "FINISHED"
    },
    {
      "text": "%spark\n",
      "user": "anonymous",
      "dateUpdated": "2025-03-30 15:09:56.562",
      "progress": 0,
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1743347396562_384056749",
      "id": "paragraph_1743347396562_384056749",
      "dateCreated": "2025-03-30 15:09:56.562",
      "status": "READY"
    }
  ],
  "name": "BDA Lab Log analysis with DataFrames",
  "id": "2KRC1SGTM",
  "defaultInterpreterGroup": "spark",
  "version": "0.12.0",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}